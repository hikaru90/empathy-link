import{s as Oe,v as Ce,i as W,f as p,k as Ie,w as Re,x as Ge,e as v,a as I,t as K,c as $,b as D,g as E,d as Q,y as Be,p as _,h as i,j as U,z as Je,n as Ke}from"../chunks/scheduler.BmBrB_dT.js";import{S as Qe,i as Ue,t as k,c as Ee,a as b,g as Ve,b as S,d as A,m as C,e as F}from"../chunks/index.BQZQ5DB3.js";import{t as We,l as Xe,b as Ye,d as Ze,e as Fe}from"../chunks/helpers.g8wrkI0H.js";import{A as et,a as tt}from"../chunks/AppBottomMenu.CkXkkK6h.js";import{p as re}from"../chunks/pocketbase.Ce4YzWbP.js";import{S as rt}from"../chunks/Share.CIl3d03I.js";import{F as Ne,T as at}from"../chunks/FightDisplay.DZ1SKm3W.js";import{p as nt}from"../chunks/stores.BdCL2gQQ.js";import{S as st}from"../chunks/skeleton.BQQp5uE_.js";import{g as lt}from"../chunks/entry.DnNy0IhO.js";import{B as Pe}from"../chunks/button.D_ITeu-i.js";import{C as ot}from"../chunks/Check.CFBCV6Q5.js";function He(s,e,t){const r=s.slice();return r[13]=e[t],r}function it(s){let e,t,r,a,o,u=s[6]("default.page.fight.resolved")+"",y,l,c,g,x,V,O=s[6]("default.page.fight.heading")+"",X,w,R=s[7]==="en"?"with":"mit",ce,he,Y,ae=s[1].name+"",fe,_e,L,Z,ne=s[5](s[1].created)+"",ue,ve,B,se=s[7]==="en"?"on the":"am",de,$e,le=new Intl.DateTimeFormat("de-DE").format(new Date(s[1].created))+"",me,be,z,T,we,M,G,ze='<div style="background: radial-gradient(circle at center, rgba(255,255,255,0.7), transparent 67%);" class="absolute left-0 top-20 z-0 h-[800px] w-[800px] -translate-x-1/2 -translate-y-1/2 transform opacity-10"></div>',ke,ee,N,ye,xe,P,j;r=new et({});const Te=[ut,ft],q=[];function je(n,f){return n[3]?1:0}z=je(s),T=q[z]=Te[z](s),N=new Ne({props:{record:s[1]}});let J=Fe(s[2]),d=[];for(let n=0;n<J.length;n+=1)d[n]=Le(He(s,J,n));const qe=n=>k(d[n],1,1,()=>{d[n]=null});return P=new tt({props:{$$slots:{default:[pt]},$$scope:{ctx:s}}}),{c(){e=v("div"),t=v("div"),S(r.$$.fragment),a=I(),o=v("div"),y=K(u),c=I(),g=v("div"),x=v("div"),V=v("h1"),X=K(O),w=I(),ce=K(R),he=I(),Y=v("span"),fe=K(ae),_e=I(),L=v("div"),Z=v("div"),ue=K(ne),ve=I(),B=v("div"),de=K(se),$e=I(),me=K(le),be=I(),T.c(),we=I(),M=v("div"),G=v("div"),G.innerHTML=ze,ke=I(),ee=v("div"),S(N.$$.fragment),ye=I();for(let n=0;n<d.length;n+=1)d[n].c();xe=I(),S(P.$$.fragment),this.h()},l(n){e=$(n,"DIV",{class:!0});var f=D(e);t=$(f,"DIV",{class:!0});var h=D(t);A(r.$$.fragment,h),a=E(h),o=$(h,"DIV",{class:!0});var oe=D(o);y=Q(oe,u),oe.forEach(p),c=E(h),g=$(h,"DIV",{class:!0});var ie=D(g);x=$(ie,"DIV",{class:!0});var m=D(x);V=$(m,"H1",{class:!0});var H=D(V);X=Q(H,O),w=E(H),ce=Q(H,R),he=E(H),Y=$(H,"SPAN",{class:!0});var Me=D(Y);fe=Q(Me,ae),Me.forEach(p),H.forEach(p),_e=E(m),L=$(m,"DIV",{class:!0});var pe=D(L);Z=$(pe,"DIV",{class:!0});var Se=D(Z);ue=Q(Se,ne),Se.forEach(p),ve=E(pe),B=$(pe,"DIV",{class:!0});var ge=D(B);de=Q(ge,se),$e=E(ge),me=Q(ge,le),ge.forEach(p),pe.forEach(p),be=E(m),T.l(m),m.forEach(p),ie.forEach(p),we=E(h),M=$(h,"DIV",{class:!0});var te=D(M);G=$(te,"DIV",{class:!0,"data-svelte-h":!0}),Be(G)!=="svelte-gzvl13"&&(G.innerHTML=ze),ke=E(te),ee=$(te,"DIV",{class:!0});var Ae=D(ee);A(N.$$.fragment,Ae),Ae.forEach(p),ye=E(te);for(let De=0;De<d.length;De+=1)d[De].l(te);te.forEach(p),xe=E(h),A(P.$$.fragment,h),h.forEach(p),f.forEach(p),this.h()},h(){_(o,"class",l=(s[1].resolved?"max-h-40 px-2 py-2 opacity-100":"max-h-0 opacity-0")+" -mt-0.5 bg-green-600 flex items-center justify-center text-white transition-all text-sm"),_(Y,"class","capitalize"),_(V,"class","font-heading flex-grow text-lg font-semibold"),_(Z,"class","mb-0.5 rounded-full bg-neutral-600 py-0.5 text-center text-2xs text-neutral-300"),_(B,"class","text-xs"),_(L,"class","flex flex-shrink-0 flex-col"),_(x,"class","relative z-10 -mx-5 flex flex-row items-center justify-between gap-3 px-5 py-4 md:items-center md:bg-transparent md:pb-6"),_(g,"class","max-container"),_(G,"class","relative z-0"),_(ee,"class","relative z-10"),_(M,"class","max-container relative pb-60 pt-10 md:bg-transparent"),_(t,"class",""),_(e,"class","overflow-hidden")},m(n,f){W(n,e,f),i(e,t),C(r,t,null),i(t,a),i(t,o),i(o,y),i(t,c),i(t,g),i(g,x),i(x,V),i(V,X),i(V,w),i(V,ce),i(V,he),i(V,Y),i(Y,fe),i(x,_e),i(x,L),i(L,Z),i(Z,ue),i(L,ve),i(L,B),i(B,de),i(B,$e),i(B,me),i(x,be),q[z].m(x,null),i(t,we),i(t,M),i(M,G),i(M,ke),i(M,ee),C(N,ee,null),i(M,ye);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(M,null);i(t,xe),C(P,t,null),j=!0},p(n,f){(!j||f&64)&&u!==(u=n[6]("default.page.fight.resolved")+"")&&U(y,u),(!j||f&2&&l!==(l=(n[1].resolved?"max-h-40 px-2 py-2 opacity-100":"max-h-0 opacity-0")+" -mt-0.5 bg-green-600 flex items-center justify-center text-white transition-all text-sm"))&&_(o,"class",l),(!j||f&64)&&O!==(O=n[6]("default.page.fight.heading")+"")&&U(X,O),(!j||f&128)&&R!==(R=n[7]==="en"?"with":"mit")&&U(ce,R),(!j||f&2)&&ae!==(ae=n[1].name+"")&&U(fe,ae),(!j||f&34)&&ne!==(ne=n[5](n[1].created)+"")&&U(ue,ne),(!j||f&128)&&se!==(se=n[7]==="en"?"on the":"am")&&U(de,se),(!j||f&2)&&le!==(le=new Intl.DateTimeFormat("de-DE").format(new Date(n[1].created))+"")&&U(me,le);let h=z;z=je(n),z===h?q[z].p(n,f):(Ve(),k(q[h],1,1,()=>{q[h]=null}),Ee(),T=q[z],T?T.p(n,f):(T=q[z]=Te[z](n),T.c()),b(T,1),T.m(x,null));const oe={};if(f&2&&(oe.record=n[1]),N.$set(oe),f&6){J=Fe(n[2]);let m;for(m=0;m<J.length;m+=1){const H=He(n,J,m);d[m]?(d[m].p(H,f),b(d[m],1)):(d[m]=Le(H),d[m].c(),b(d[m],1),d[m].m(M,null))}for(Ve(),m=J.length;m<d.length;m+=1)qe(m);Ee()}const ie={};f&65554&&(ie.$$scope={dirty:f,ctx:n}),P.$set(ie)},i(n){if(!j){b(r.$$.fragment,n),b(T),b(N.$$.fragment,n);for(let f=0;f<J.length;f+=1)b(d[f]);b(P.$$.fragment,n),j=!0}},o(n){k(r.$$.fragment,n),k(T),k(N.$$.fragment,n),d=d.filter(Boolean);for(let f=0;f<d.length;f+=1)k(d[f]);k(P.$$.fragment,n),j=!1},d(n){n&&p(e),F(r),q[z].d(),F(N),Je(d,n),F(P)}}}function ct(s){let e,t,r;return t=new st({props:{class:"h-[20px] w-[100px] rounded-full"}}),{c(){e=v("div"),S(t.$$.fragment),this.h()},l(a){e=$(a,"DIV",{class:!0});var o=D(e);A(t.$$.fragment,o),o.forEach(p),this.h()},h(){_(e,"class","flex h-full items-center justify-center")},m(a,o){W(a,e,o),C(t,e,null),r=!0},p:Ke,i(a){r||(b(t.$$.fragment,a),r=!0)},o(a){k(t.$$.fragment,a),r=!1},d(a){a&&p(e),F(t)}}}function ft(s){let e,t;return e=new Pe({props:{decoration:"floating-op1",class:"-mr-2 -mt-2 flex items-center justify-center border-red-400 bg-red-600 px-1.5 text-sm text-white transition hover:bg-offwhite",$$slots:{default:[dt]},$$scope:{ctx:s}}}),e.$on("click",s[8]),{c(){S(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,a){C(e,r,a),t=!0},p(r,a){const o={};a&65536&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function ut(s){let e,t;return e=new Pe({props:{decoration:"floating-op1",class:"-mr-2 -mt-2 flex items-center justify-center border-red-400 bg-red-600 px-1.5 text-sm text-white transition hover:bg-offwhite",$$slots:{default:[mt]},$$scope:{ctx:s}}}),e.$on("click",s[10]),{c(){S(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,a){C(e,r,a),t=!0},p(r,a){const o={};a&65536&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function dt(s){let e,t;return e=new ot({}),{c(){S(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,a){C(e,r,a),t=!0},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function mt(s){let e,t;return e=new at({}),{c(){S(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,a){C(e,r,a),t=!0},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){F(e,r)}}}function Le(s){let e,t='<div style="background: radial-gradient(circle at center, rgba(255,255,255,0.7), transparent 67%);" class="absolute left-96 top-20 z-0 h-[800px] w-[800px] -translate-x-1/2 -translate-y-1/2 transform opacity-10"></div>',r,a,o,u,y;return o=new Ne({props:{fight:s[1],record:s[13],adversary:s[1].name}}),{c(){e=v("div"),e.innerHTML=t,r=I(),a=v("div"),S(o.$$.fragment),u=I(),this.h()},l(l){e=$(l,"DIV",{class:!0,"data-svelte-h":!0}),Be(e)!=="svelte-1lvm6nt"&&(e.innerHTML=t),r=E(l),a=$(l,"DIV",{class:!0});var c=D(a);A(o.$$.fragment,c),u=E(c),c.forEach(p),this.h()},h(){_(e,"class","relative z-0"),_(a,"class","relative z-10 mt-8")},m(l,c){W(l,e,c),W(l,r,c),W(l,a,c),C(o,a,null),i(a,u),y=!0},p(l,c){const g={};c&2&&(g.fight=l[1]),c&4&&(g.record=l[13]),c&2&&(g.adversary=l[1].name),o.$set(g)},i(l){y||(b(o.$$.fragment,l),y=!0)},o(l){k(o.$$.fragment,l),y=!1},d(l){l&&(p(e),p(r),p(a)),F(o)}}}function pt(s){let e,t,r;return t=new rt({props:{id:s[4],record:s[1]}}),{c(){e=v("div"),S(t.$$.fragment),this.h()},l(a){e=$(a,"DIV",{class:!0});var o=D(e);A(t.$$.fragment,o),o.forEach(p),this.h()},h(){_(e,"class","flex items-center justify-between gap-3")},m(a,o){W(a,e,o),C(t,e,null),r=!0},p(a,o){const u={};o&16&&(u.id=a[4]),o&2&&(u.record=a[1]),t.$set(u)},i(a){r||(b(t.$$.fragment,a),r=!0)},o(a){k(t.$$.fragment,a),r=!1},d(a){a&&p(e),F(t)}}}function gt(s){let e,t,r,a;const o=[ct,it],u=[];function y(l,c){return l[0]?1:0}return e=y(s),t=u[e]=o[e](s),{c(){t.c(),r=Ce()},l(l){t.l(l),r=Ce()},m(l,c){u[e].m(l,c),W(l,r,c),a=!0},p(l,[c]){let g=e;e=y(l),e===g?u[e].p(l,c):(Ve(),k(u[g],1,1,()=>{u[g]=null}),Ee(),t=u[e],t?t.p(l,c):(t=u[e]=o[e](l),t.c()),b(t,1),t.m(r.parentNode,r))},i(l){a||(b(t),a=!0)},o(l){k(t),a=!1},d(l){l&&p(r),u[e].d(l)}}}function ht(s,e,t){let r,a,o,u,y;Ie(s,nt,w=>t(9,o=w)),Ie(s,We,w=>t(6,u=w)),Ie(s,Xe,w=>t(7,y=w));let l=!1,c,g=[],x=!1;const V=async()=>{re.collection("fights").subscribe(r,function(w){t(1,c=w.record)},{expand:"feelings, needs, owner"}),t(1,c=await re.collection("fights").getOne(r,{expand:"feelings, needs, owner"})),re.collection("responses").subscribe("*",function(w){if(w.action==="create"&&w.record.fight===c.id){const R=w.record;t(2,g=[...g,R])}},{expand:"fight, feelings, needs"}),t(2,g=await re.collection("responses").getFullList({filter:`fight = '${c.id}'`,expand:"fight, feelings, needs"}))},O=async()=>{try{await re.collection("fights").delete(r),t(3,x=!1),lt("/app/auth/login")}catch{console.error("error deleting fight")}};Re(async()=>{await V(),t(0,l=!0),Ye.set("bg-background"),console.log("record",c),console.log("responses",g)}),Ge(()=>{re.collection("responses").unsubscribe("*")});const X=()=>t(3,x=!0);return s.$$.update=()=>{s.$$.dirty&512&&t(4,r=o.params.id),s.$$.dirty&3&&t(5,a=()=>l?Ze(c.created):"...")},[l,c,g,x,r,a,u,y,O,o,X]}class zt extends Qe{constructor(e){super(),Ue(this,e,ht,gt,Oe,{})}}export{zt as component};
