{"version":3,"file":"_server.ts-XjmznJCn.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/ai/checkForJudgement/_server.ts.js"],"sourcesContent":["import { P as PRIVATE_GEMINI_API_KEY } from \"../../../../../chunks/private.js\";\nimport { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from \"@google/generative-ai\";\nconst genAI = new GoogleGenerativeAI(PRIVATE_GEMINI_API_KEY);\nconst POST = async ({ request }) => {\n  const { text, lang } = await request.json();\n  const model = genAI.getGenerativeModel({\n    model: \"gemini-1.5-flash\",\n    systemInstruction: \"you are an expert that is trained to identify if an observation contains a judgement based on nonviolent communication principles. You receive texts and answer if the observation contains a jugement or not. if it does, make a suggestion that doesn't. please make sure that the text really has to contain a judgment for you to point it out. If the prompt is in german, please answer in german.\"\n  });\n  const safetySettings = [\n    {\n      category: HarmCategory.HARM_CATEGORY_HARASSMENT,\n      threshold: HarmBlockThreshold.BLOCK_NONE\n    },\n    {\n      category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,\n      threshold: HarmBlockThreshold.BLOCK_NONE\n    }\n  ];\n  const generationConfig = {\n    temperature: 0,\n    topP: 0.95,\n    topK: 64,\n    maxOutputTokens: 8192,\n    responseMimeType: \"text/plain\"\n  };\n  console.log(\"text\", text);\n  console.log(\"lang\", lang);\n  try {\n    const chatSession = model.startChat({\n      generationConfig,\n      safetySettings,\n      history: []\n    });\n    const result = await chatSession.sendMessage(text);\n    console.log(\"result\", result);\n    console.log(\"typeof result\", typeof result);\n    const response = result.response;\n    const resText = response.text();\n    console.log(text);\n    return new Response(JSON.stringify({ result: resText }), {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n  } catch (error) {\n    console.error(\"Error checking for judgment:\", error);\n    return new Response(\n      JSON.stringify({ error: \"Failed to check for judgment.\", result: lang === \"en\" ? \"Your observation might contain a judgement. Please make sure to keep to the facts and be as neutral as possible.\" : \"DeinBeobachtung enthält wahrscheinlich ein Urteil. Sei bitte so objektiv wie möglich bei der Beschreibung der Situation.\" }),\n      {\n        status: 200,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }\n    );\n  }\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,KAAK,GAAG,IAAI,kBAAkB,CAAC,sBAAsB,CAAC,CAAC;AACxD,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AAC9C,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,kBAAkB,CAAC;AACzC,IAAI,KAAK,EAAE,kBAAkB;AAC7B,IAAI,iBAAiB,EAAE,0YAA0Y;AACja,GAAG,CAAC,CAAC;AACL,EAAE,MAAM,cAAc,GAAG;AACzB,IAAI;AACJ,MAAM,QAAQ,EAAE,YAAY,CAAC,wBAAwB;AACrD,MAAM,SAAS,EAAE,kBAAkB,CAAC,UAAU;AAC9C,KAAK;AACL,IAAI;AACJ,MAAM,QAAQ,EAAE,YAAY,CAAC,yBAAyB;AACtD,MAAM,SAAS,EAAE,kBAAkB,CAAC,UAAU;AAC9C,KAAK;AACL,GAAG,CAAC;AACJ,EAAE,MAAM,gBAAgB,GAAG;AAC3B,IAAI,WAAW,EAAE,CAAC;AAClB,IAAI,IAAI,EAAE,IAAI;AACd,IAAI,IAAI,EAAE,EAAE;AACZ,IAAI,eAAe,EAAE,IAAI;AACzB,IAAI,gBAAgB,EAAE,YAAY;AAClC,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AAC5B,EAAE,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AAC5B,EAAE,IAAI;AACN,IAAI,MAAM,WAAW,GAAG,KAAK,CAAC,SAAS,CAAC;AACxC,MAAM,gBAAgB;AACtB,MAAM,cAAc;AACpB,MAAM,OAAO,EAAE,EAAE;AACjB,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;AACvD,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAClC,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,OAAO,MAAM,CAAC,CAAC;AAChD,IAAI,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;AACrC,IAAI,MAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC;AACpC,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtB,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,EAAE;AAC7D,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE,kBAAkB;AAC1C,OAAO;AACP,KAAK,CAAC,CAAC;AACP,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;AACzD,IAAI,OAAO,IAAI,QAAQ;AACvB,MAAM,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,+BAA+B,EAAE,MAAM,EAAE,IAAI,KAAK,IAAI,GAAG,kHAAkH,GAAG,0HAA0H,EAAE,CAAC;AACzU,MAAM;AACN,QAAQ,MAAM,EAAE,GAAG;AACnB,QAAQ,OAAO,EAAE;AACjB,UAAU,cAAc,EAAE,kBAAkB;AAC5C,SAAS;AACT,OAAO;AACP,KAAK,CAAC;AACN,GAAG;AACH;;;;"}