{"version":3,"file":"_server.ts-BA_l0vC5.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/mails/send/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../../chunks/index.js\";\nconst PRIVATE_BREVO_API_KEY = \"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\";\nconst getTemplate = (templateName, locale, formData) => {\n  const templates = [\n    {\n      name: \"sendLink\",\n      subject: locale === \"en\" ? \"You received an Empathy-Link\" : \"Du hast einen Empathie-Link erhalten\",\n      content: `<html><body>\n      ${locale === \"en\" ? \"Dear \" : \"Liebe/r \"} ${formData.recipientName}, <br />\n      ${formData.owner} ${locale === \"en\" ? \" has sent you an Empathy-Link\" : \" hat Dir einen Empathie-Link geschickt\"}. <br /><br />\n\n      <a href=\"${formData.link}\">${locale === \"en\" ? \"Open your Empathy-Link\" : \"Öffne Deinen Empathie-Link\"}</a><br /><br />\n      \n      Liebe Grüße<br />\n      </body></html>`\n    }\n  ];\n  return templates.find((template) => template.name === templateName);\n};\nconst sendMail = async (template, locale, to, formData) => {\n  const response = await fetch(\"https://api.brevo.com/v3/smtp/email\", {\n    method: \"POST\",\n    headers: {\n      accept: \"application/json\",\n      \"api-key\": PRIVATE_BREVO_API_KEY,\n      \"content-type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      sender: {\n        email: \"kontakt@empathy-link.de\",\n        name: `Alex`\n      },\n      replyTo: {\n        email: \"kontakt@empathy-link.de\",\n        name: `Alex`\n      },\n      to: [{ email: to }],\n      subject: getTemplate(template, locale, formData).subject,\n      htmlContent: getTemplate(template, locale, formData).content\n    })\n  });\n  if (!response.ok) {\n    return \"Message could not be sent at this time.\";\n  }\n};\nconst prerender = false;\nasync function POST({ request, cookies }) {\n  try {\n    const body = await request.json();\n    sendMail(body.template, body.locale, body.to, {\n      owner: body.owner,\n      recipientName: body.recipientName,\n      link: body.link\n    });\n    return json({ result: \"mail sent\" }, { status: 200 });\n  } catch (err) {\n    console.log(\"error in sending mail\", err);\n    return json({ error: err }, { status: 500 });\n  }\n}\nexport {\n  POST,\n  prerender\n};\n"],"names":[],"mappings":";;AACA,MAAM,qBAAqB,GAAG,2FAA2F,CAAC;AAC1H,MAAM,WAAW,GAAG,CAAC,YAAY,EAAE,MAAM,EAAE,QAAQ,KAAK;AACxD,EAAE,MAAM,SAAS,GAAG;AACpB,IAAI;AACJ,MAAM,IAAI,EAAE,UAAU;AACtB,MAAM,OAAO,EAAE,MAAM,KAAK,IAAI,GAAG,8BAA8B,GAAG,sCAAsC;AACxG,MAAM,OAAO,EAAE,CAAC;AAChB,MAAM,EAAE,MAAM,KAAK,IAAI,GAAG,OAAO,GAAG,UAAU,CAAC,CAAC,EAAE,QAAQ,CAAC,aAAa,CAAC;AACzE,MAAM,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,KAAK,IAAI,GAAG,+BAA+B,GAAG,wCAAwC,CAAC;AACvH;AACA,eAAe,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,KAAK,IAAI,GAAG,wBAAwB,GAAG,4BAA4B,CAAC;AAC7G;AACA;AACA,oBAAoB,CAAC;AACrB,KAAK;AACL,GAAG,CAAC;AACJ,EAAE,OAAO,SAAS,CAAC,IAAI,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,KAAK,YAAY,CAAC,CAAC;AACtE,CAAC,CAAC;AACF,MAAM,QAAQ,GAAG,OAAO,QAAQ,EAAE,MAAM,EAAE,EAAE,EAAE,QAAQ,KAAK;AAC3D,EAAE,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,qCAAqC,EAAE;AACtE,IAAI,MAAM,EAAE,MAAM;AAClB,IAAI,OAAO,EAAE;AACb,MAAM,MAAM,EAAE,kBAAkB;AAChC,MAAM,SAAS,EAAE,qBAAqB;AACtC,MAAM,cAAc,EAAE,kBAAkB;AACxC,KAAK;AACL,IAAI,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC;AACzB,MAAM,MAAM,EAAE;AACd,QAAQ,KAAK,EAAE,yBAAyB;AACxC,QAAQ,IAAI,EAAE,CAAC,IAAI,CAAC;AACpB,OAAO;AACP,MAAM,OAAO,EAAE;AACf,QAAQ,KAAK,EAAE,yBAAyB;AACxC,QAAQ,IAAI,EAAE,CAAC,IAAI,CAAC;AACpB,OAAO;AACP,MAAM,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;AACzB,MAAM,OAAO,EAAE,WAAW,CAAC,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,OAAO;AAC9D,MAAM,WAAW,EAAE,WAAW,CAAC,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,OAAO;AAClE,KAAK,CAAC;AACN,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;AACpB,IAAI,OAAO,yCAAyC,CAAC;AACrD,GAAG;AACH,CAAC,CAAC;AACG,MAAC,SAAS,GAAG,MAAM;AACxB,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,EAAE;AAC1C,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACtC,IAAI,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;AAClD,MAAM,KAAK,EAAE,IAAI,CAAC,KAAK;AACvB,MAAM,aAAa,EAAE,IAAI,CAAC,aAAa;AACvC,MAAM,IAAI,EAAE,IAAI,CAAC,IAAI;AACrB,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,IAAI,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC1D,GAAG,CAAC,OAAO,GAAG,EAAE;AAChB,IAAI,OAAO,CAAC,GAAG,CAAC,uBAAuB,EAAE,GAAG,CAAC,CAAC;AAC9C,IAAI,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACjD,GAAG;AACH;;;;"}