import{s as ke,e as V,a as J,c as y,b as j,f as g,g as q,p as F,i as w,h as A,k as ue,_ as It,n as X,t as Y,d as Z,j as x,F as G,E as Xe,S as St,x as be,y as Ye,K as le,$ as Bt,J as Dt,L as oe,I as Ft,O as ee,z as Tt,l as me,M as ve,U as Ze}from"../chunks/scheduler.DdioMMNe.js";import{S as Fe,i as Te,c as k,a as E,m as C,g as R,b as _,f as K,t as m,d as I,e as ae}from"../chunks/index.DwuYAy9N.js";import{b as Nt,h as ye,i as Ee,e as te}from"../chunks/helpers.DRuoA_Ub.js";import{t as H,l as xe,u as Vt,h as yt,g as ge,a as pe}from"../chunks/page.CF0Ovvew.js";import{A as Jt,p as Ce}from"../chunks/pocketbase.D5VS0VDr.js";import{A as et}from"../chunks/AppBottomMenu.Dq_ZJfxR.js";import{c as se,z as jt,F as ce,C as _e,a as de,b as $e}from"../chunks/zod.Dpy8eUe1.js";import{I as tt}from"../chunks/input.ArILh4x_.js";import{A as rt,C as qt,a as zt,F as Ot,T as lt,b as nt,c as st}from"../chunks/textarea.Bm8zcuhN.js";import"../chunks/entry.Bj8-M4tG.js";import{z as re,s as At}from"../chunks/memoize.DKCXd2wb.js";import{d as Mt}from"../chunks/index.WpHQCfF7.js";import{a as Ne}from"../chunks/button.B35vIzx1.js";import{C as Ht}from"../chunks/CaretLeft.DecFd9iH.js";import{I as Lt}from"../chunks/icon-folder.CBGieXVr.js";import{I as Ut,a as Pt,b as Rt,c as Je}from"../chunks/icon-steps.dGSELuxl.js";import{S as Kt}from"../chunks/Share.D0C-0Nl0.js";function Wt(o){let e,l;return e=new Ht({props:{class:"h-4 w-4 rounded-full"}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p:X,i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function Gt(o){let e,l;return e=new Ne({props:{type:"submit",decoration:"dark-op1",wrapperClass:"w-full",class:"flex w-full items-center gap-2 border-neutral-900 bg-neutral-800 text-sm text-zinc-200",$$slots:{default:[Xt]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r&264&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function Qt(o){let e,l;return e=new Ne({props:{decoration:"dark-op1",wrapperClass:"w-full",class:"flex w-full items-center gap-2 border-neutral-900 bg-neutral-800 text-sm text-zinc-200",$$slots:{default:[Yt]},$$scope:{ctx:o}}}),e.$on("click",o[5]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r&264&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function Xt(o){let e=o[3]("default.page.fights.form.general.next")+"",l,t,r,n;return r=new rt({props:{class:"h-3 w-3"}}),{c(){l=Y(e),t=J(),k(r.$$.fragment)},l(s){l=Z(s,e),t=q(s),E(r.$$.fragment,s)},m(s,i){w(s,l,i),w(s,t,i),C(r,s,i),n=!0},p(s,i){(!n||i&8)&&e!==(e=s[3]("default.page.fights.form.general.next")+"")&&x(l,e)},i(s){n||(m(r.$$.fragment,s),n=!0)},o(s){_(r.$$.fragment,s),n=!1},d(s){s&&(g(l),g(t)),I(r,s)}}}function Yt(o){let e=o[3]("default.page.fights.form.general.checkJudgement")+"",l,t,r,n;return r=new rt({props:{class:"h-3 w-3"}}),{c(){l=Y(e),t=J(),k(r.$$.fragment)},l(s){l=Z(s,e),t=q(s),E(r.$$.fragment,s)},m(s,i){w(s,l,i),w(s,t,i),C(r,s,i),n=!0},p(s,i){(!n||i&8)&&e!==(e=s[3]("default.page.fights.form.general.checkJudgement")+"")&&x(l,e)},i(s){n||(m(r.$$.fragment,s),n=!0)},o(s){_(r.$$.fragment,s),n=!1},d(s){s&&(g(l),g(t)),I(r,s)}}}function Zt(o){let e,l,t,r,n,s,i,f,a;t=new Ne({props:{decoration:"dark-op1",class:"flex items-center border-neutral-900 bg-neutral-800 px-1.5 text-sm text-zinc-200",$$slots:{default:[Wt]},$$scope:{ctx:o}}}),t.$on("click",o[4]);const u=[Qt,Gt],p=[];function h(c,b){return c[1]?0:1}return s=h(o),i=p[s]=u[s](o),{c(){e=V("div"),l=V("div"),k(t.$$.fragment),n=J(),i.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var b=j(e);l=y(b,"DIV",{class:!0});var d=j(l);E(t.$$.fragment,d),d.forEach(g),n=q(b),i.l(b),b.forEach(g),this.h()},h(){F(l,"class",r=(o[0]>1?"max-w-60 opacity-100":"max-w-0 opacity-0")+" group relative transform overflow-visible"),F(e,"class",f="flex justify-between "+o[2])},m(c,b){w(c,e,b),A(e,l),C(t,l,null),A(e,n),p[s].m(e,null),a=!0},p(c,[b]){const d={};b&256&&(d.$$scope={dirty:b,ctx:c}),t.$set(d),(!a||b&1&&r!==(r=(c[0]>1?"max-w-60 opacity-100":"max-w-0 opacity-0")+" group relative transform overflow-visible"))&&F(l,"class",r);let v=s;s=h(c),s===v?p[s].p(c,b):(R(),_(p[v],1,1,()=>{p[v]=null}),K(),i=p[s],i?i.p(c,b):(i=p[s]=u[s](c),i.c()),m(i,1),i.m(e,null)),(!a||b&4&&f!==(f="flex justify-between "+c[2]))&&F(e,"class",f)},i(c){a||(m(t.$$.fragment,c),m(i),a=!0)},o(c){_(t.$$.fragment,c),_(i),a=!1},d(c){c&&g(e),I(t),p[s].d()}}}function xt(o,e,l){let t;ue(o,H,p=>l(3,t=p));const r=It();let{step:n}=e,{checkForJudgement:s}=e,{class:i=void 0}=e,{primaryButtonClass:f=void 0}=e;const a=()=>{console.log("toPrev"),r("toPrev")},u=()=>{r("validateObservation")};return o.$$set=p=>{"step"in p&&l(0,n=p.step),"checkForJudgement"in p&&l(1,s=p.checkForJudgement),"class"in p&&l(2,i=p.class),"primaryButtonClass"in p&&l(6,f=p.primaryButtonClass)},[n,s,i,t,a,u,f]}class er extends Fe{constructor(e){super(),Te(this,e,xt,Zt,ke,{step:0,checkForJudgement:1,class:2,primaryButtonClass:6})}}const Ie=re.object({name:re.string().min(3,{message:G(H)("default.page.fights.form.name.tooShortError")}),title:re.string().min(3,{message:G(H)("default.page.fights.form.title.tooShortError")})}),Se=Ie.extend({observation:re.string().min(10,{message:G(H)("default.page.fights.form.observation.tooShortError")})}),Be=Se.extend({feelings:re.array(re.string()).min(1,{message:G(H)("default.page.fights.form.feelings.tooFewError")})}),De=Be.extend({needs:re.array(re.string()).min(1,{message:G(H)("default.page.fights.form.needs.tooFewError")})}),ie=De.extend({request:re.string().min(10,{message:G(H)("default.page.fights.form.request.tooFewError")})});function tr(o){let e;return{c(){e=V("div"),this.h()},l(l){e=y(l,"DIV",{id:!0,class:!0}),j(e).forEach(g),this.h()},h(){F(e,"id","speechBubble"),F(e,"class","w-full")},m(l,t){w(l,e,t),o[11](e)},p:X,d(l){l&&g(e),o[11](null)}}}function rr(o){let e,l="...";return{c(){e=V("div"),e.textContent=l,this.h()},l(t){e=y(t,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),Xe(e)!=="svelte-534rav"&&(e.textContent=l),this.h()},h(){F(e,"id","speechBubble"),F(e,"class","w-full")},m(t,r){w(t,e,r)},p:X,d(t){t&&g(e)}}}function je(o){let e,l,t,r,n,s,i,f,a,u;return r=new qt({props:{class:"size-2.5"}}),i=new zt({props:{class:"size-2.5"}}),{c(){e=V("div"),l=V("div"),t=V("button"),k(r.$$.fragment),n=J(),s=V("button"),k(i.$$.fragment),this.h()},l(p){e=y(p,"DIV",{class:!0});var h=j(e);l=y(h,"DIV",{class:!0});var c=j(l);t=y(c,"BUTTON",{class:!0});var b=j(t);E(r.$$.fragment,b),b.forEach(g),n=q(c),s=y(c,"BUTTON",{class:!0});var d=j(s);E(i.$$.fragment,d),d.forEach(g),c.forEach(g),h.forEach(g),this.h()},h(){F(t,"class","chevron svelte-12yl6i5"),F(s,"class","chevron svelte-12yl6i5"),F(l,"class","-mr-1 flex flex-col items-center gap-0.5"),F(e,"class","flex justify-end text-2xs")},m(p,h){w(p,e,h),A(e,l),A(l,t),C(r,t,null),A(l,n),A(l,s),C(i,s,null),f=!0,a||(u=[be(t,"click",o[12]),be(s,"click",o[13])],a=!0)},p:X,i(p){f||(m(r.$$.fragment,p),m(i.$$.fragment,p),f=!0)},o(p){_(r.$$.fragment,p),_(i.$$.fragment,p),f=!1},d(p){p&&g(e),I(r),I(i),a=!1,Ye(u)}}}function lr(o){let e,l,t=`<div style="background-image: url(&#39;${Nt}&#39;); background-size: 300% 100%" class="animate-bg relative z-10 flex h-full w-[60px] items-center justify-center rounded-b rounded-t-[50px] shadow-lg transition duration-700"><div data-name="face" class="lookaround face-3 flex flex-col gap-1 svelte-12yl6i5"><div data-name="eyes" class="eyes flex items-center justify-center gap-2"><div class="h-2 w-2 rounded-full border-2 border-white bg-black shadow-md"></div> <div class="h-2 w-2 rounded-full border-2 border-white bg-black shadow-md"></div></div> <div data-name="mouth" class="mouth flex items-center justify-center svelte-12yl6i5"><div class="h-1.5 w-2.5 rounded-b-full bg-black"></div></div></div></div>`,r,n,s,i,f,a,u;function p(d,v){return d[2]?rr:tr}let h=p(o),c=h(o),b=o[1].length>1&&je(o);return{c(){e=V("div"),l=V("div"),l.innerHTML=t,r=J(),n=V("div"),s=V("div"),i=J(),f=V("div"),c.c(),a=J(),b&&b.c(),this.h()},l(d){e=y(d,"DIV",{class:!0});var v=j(e);l=y(v,"DIV",{class:!0,"data-svelte-h":!0}),Xe(l)!=="svelte-ido9h0"&&(l.innerHTML=t),r=q(v),n=y(v,"DIV",{class:!0});var T=j(n);s=y(T,"DIV",{class:!0}),j(s).forEach(g),i=q(T),f=y(T,"DIV",{class:!0});var N=j(f);c.l(N),a=q(N),b&&b.l(N),N.forEach(g),T.forEach(g),v.forEach(g),this.h()},h(){F(l,"class","relative left-0 right-0 flex h-12 flex-shrink-0 justify-center gap-1"),F(s,"class","triangle size-3 flex-shrink-0 bg-muted svelte-12yl6i5"),F(f,"class","rounded-tl-0 relative flex flex-grow rounded-b rounded-tr bg-muted px-2 pb-2 pt-1 text-sm leading-tight gap-2"),F(n,"class","flex flex-grow"),F(e,"class","mt-4 flex items-start gap-2")},m(d,v){w(d,e,v),A(e,l),A(e,r),A(e,n),A(n,s),A(n,i),A(n,f),c.m(f,null),A(f,a),b&&b.m(f,null),u=!0},p(d,[v]){h===(h=p(d))&&c?c.p(d,v):(c.d(1),c=h(d),c&&(c.c(),c.m(f,a))),d[1].length>1?b?(b.p(d,v),v&2&&m(b,1)):(b=je(d),b.c(),m(b,1),b.m(f,null)):b&&(R(),_(b,1,1,()=>{b=null}),K())},i(d){u||(m(b),u=!0)},o(d){_(b),u=!1},d(d){d&&g(e),c.d(),b&&b.d()}}}function nr(o,e,l){let t,r;ue(o,xe,S=>l(15,r=S));let{step:n}=e,{stepName:s}=e,{formSuccess:i}=e,{speechBubbleContentArray:f}=e,a=0,u=!1,p,h;const c=(S,Q,L)=>{try{let W=function(){B<Q.length&&(S.innerHTML+=Q.charAt(B),B++,h=setTimeout(W,L))};console.log("typeText");let B=0;S.innerHTML="";const D=document.createElement("div");D.style.visibility="hidden",D.style.position="absolute",D.style.width=`${S.clientWidth}px`,D.style.color="red",D.style.whiteSpace="pre-wrap",D.innerText=Q,S.appendChild(D);const U=D.clientHeight;S.style.height=`${U}px`,S.removeChild(D),h&&clearTimeout(h),W()}catch(W){console.error("error typing text",W)}},b=(S="Hi")=>{l(1,t=[t[0],S]),l(10,a=1)},d=async S=>{l(2,u=!0);try{const L=await(await fetch("/api/ai/checkForJudgement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:S,lang:r})})).json();l(2,u=!1);const W=L.result;b(W)}catch(Q){console.error("error in getting judgement",Q)}},v=()=>{console.log("decreaseIndex"),a>0&&l(10,a--,a)},T=()=>{console.log("increaseIndex"),t.length>1&&a===0&&l(10,a++,a)};St(()=>{h&&clearTimeout(h)});function N(S){le[S?"unshift":"push"](()=>{p=S,l(0,p)})}const he=()=>v(),fe=()=>T();return o.$$set=S=>{"step"in S&&l(5,n=S.step),"stepName"in S&&l(6,s=S.stepName),"formSuccess"in S&&l(7,i=S.formSuccess),"speechBubbleContentArray"in S&&l(8,f=S.speechBubbleContentArray)},o.$$.update=()=>{o.$$.dirty&416&&l(1,t=n===6&&!i?f.find(S=>S.step===6).errorContent:f.find(S=>S.step===n).content),o.$$.dirty&32&&l(10,a=0),o.$$.dirty&1027&&p&&(console.log("inside if speechBubbleElement"),c(p,t[a],30))},[p,t,u,v,T,n,s,i,f,d,a,N,he,fe]}class sr extends Fe{constructor(e){super(),Te(this,e,nr,lr,ke,{step:5,stepName:6,formSuccess:7,speechBubbleContentArray:8,checkJudgement:9})}get checkJudgement(){return this.$$.ctx[9]}}function qe(o,e,l){const t=o.slice();return t[52]=e[l],t}function ze(o,e,l){const t=o.slice();return t[60]=e[l],t}function Oe(o,e,l){const t=o.slice();return t[49]=e[l],t}function Ae(o,e,l){const t=o.slice();return t[52]=e[l],t}function Me(o,e,l){const t=o.slice();return t[55]=e[l],t}function He(o){let e,l;return e=new Ot({props:{step:o[0],steps:o[8],stepBackground:o[8][o[0]-1].slug}}),e.$on("changeStep",o[20]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.step=t[0]),r[0]&256&&(n.steps=t[8]),r[0]&257&&(n.stepBackground=t[8][t[0]-1].slug),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function or(o){let e;return{c(){e=V("div")},l(l){e=y(l,"DIV",{}),j(e).forEach(g)},m(l,t){w(l,e,t)},p:X,i:X,o:X,d(l){l&&g(e)}}}function ar(o){let e;return{c(){e=V("div")},l(l){e=y(l,"DIV",{}),j(e).forEach(g)},m(l,t){w(l,e,t)},p:X,i:X,o:X,d(l){l&&g(e)}}}function fr(o){let e,l,t;return l=new ce({props:{form:o[16],name:"request",$$slots:{default:[_r]},$$scope:{ctx:o}}}),{c(){e=V("div"),k(l.$$.fragment),this.h()},l(r){e=y(r,"DIV",{class:!0});var n=j(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){F(e,"class","form-content")},m(r,n){w(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&3072|n[2]&2&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){_(l.$$.fragment,r),t=!1},d(r){r&&g(e),I(l)}}}function ir(o){let e,l,t;return l=new ce({props:{form:o[16],name:"needs",$$slots:{default:[vr]},$$scope:{ctx:o}}}),{c(){e=V("div"),k(l.$$.fragment),this.h()},l(r){e=y(r,"DIV",{class:!0});var n=j(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){F(e,"class","form-content")},m(r,n){w(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&7172|n[2]&2&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){_(l.$$.fragment,r),t=!1},d(r){r&&g(e),I(l)}}}function ur(o){let e,l,t;return l=new ce({props:{form:o[16],name:"feelings",$$slots:{default:[Ir]},$$scope:{ctx:o}}}),{c(){e=V("div"),k(l.$$.fragment),this.h()},l(r){e=y(r,"DIV",{class:!0});var n=j(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){F(e,"class","form-content")},m(r,n){w(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&7427|n[2]&2&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){_(l.$$.fragment,r),t=!1},d(r){r&&g(e),I(l)}}}function cr(o){let e,l,t;return l=new ce({props:{form:o[16],name:"observation",$$slots:{default:[Dr]},$$scope:{ctx:o}}}),{c(){e=V("div"),k(l.$$.fragment),this.h()},l(r){e=y(r,"DIV",{class:!0});var n=j(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){F(e,"class","form-content")},m(r,n){w(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&3136|n[2]&2&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){_(l.$$.fragment,r),t=!1},d(r){r&&g(e),I(l)}}}function mr(o){let e,l,t,r,n;return l=new ce({props:{form:o[16],name:"name",$$slots:{default:[Nr]},$$scope:{ctx:o}}}),r=new ce({props:{form:o[16],name:"title",$$slots:{default:[Jr]},$$scope:{ctx:o}}}),{c(){e=V("div"),k(l.$$.fragment),t=J(),k(r.$$.fragment),this.h()},l(s){e=y(s,"DIV",{class:!0});var i=j(e);E(l.$$.fragment,i),t=q(i),E(r.$$.fragment,i),i.forEach(g),this.h()},h(){F(e,"class","form-content")},m(s,i){w(s,e,i),C(l,e,null),A(e,t),C(r,e,null),n=!0},p(s,i){const f={};i[0]&3072|i[2]&2&&(f.$$scope={dirty:i,ctx:s}),l.$set(f);const a={};i[0]&3072|i[2]&2&&(a.$$scope={dirty:i,ctx:s}),r.$set(a)},i(s){n||(m(l.$$.fragment,s),m(r.$$.fragment,s),n=!0)},o(s){_(l.$$.fragment,s),_(r.$$.fragment,s),n=!1},d(s){s&&g(e),I(l),I(r)}}}function gr(o){let e=o[11]("default.page.fights.form.request.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.request.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function pr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[gr]},$$scope:{ctx:o}}});const s=[o[48],{class:"min-h-60"}];function i(a){o[32](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].request!==void 0&&(f.value=o[10].request),t=new lt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[pe(a[48]),s[1]]):{};!r&&u[0]&1024&&(r=!0,h.value=a[10].request,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function _r(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[pr,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&3072|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function dr(o){let e=o[11]("default.page.fights.form.needs.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.needs.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Le(o){let e,l,t=te(o[2]),r=[];for(let s=0;s<t.length;s+=1)r[s]=Pe(qe(o,t,s));const n=s=>_(r[s],1,1,()=>{r[s]=null});return{c(){e=V("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=y(s,"DIV",{class:!0});var i=j(e);for(let f=0;f<r.length;f+=1)r[f].l(i);i.forEach(g),this.h()},h(){F(e,"class","-m-1 flex w-full flex-wrap justify-start transition-all")},m(s,i){w(s,e,i);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);l=!0},p(s,i){if(i[0]&10490884){t=te(s[2]);let f;for(f=0;f<t.length;f+=1){const a=qe(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Pe(a),r[f].c(),m(r[f],1),r[f].m(e,null))}for(R(),f=t.length;f<r.length;f+=1)n(f);K()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)_(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function $r(o){let e=(o[12]==="de"?o[60].nameDE:o[60].nameEN)+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&4100&&e!==(e=(t[12]==="de"?t[60].nameDE:t[60].nameEN)+"")&&x(l,e)},d(t){t&&g(l)}}}function Ue(o){let e,l,t,r,n,s,i;return l=new st({props:{value:o[60].id,class:(o[60].nameEN===o[52].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-needs-foreground dark:data-[state=on]:bg-needs-foreground max-w-[300px]",$$slots:{default:[$r]},$$scope:{ctx:o}}}),{c(){e=V("button"),k(l.$$.fragment),t=J(),this.h()},l(f){e=y(f,"BUTTON",{type:!0,class:!0});var a=j(e);E(l.$$.fragment,a),t=q(a),a.forEach(g),this.h()},h(){F(e,"type","button"),F(e,"class",r=(o[23](o[60],o[52])||o[10].needs.includes(o[60].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all")},m(f,a){w(f,e,a),C(l,e,null),A(e,t),n=!0,s||(i=be(e,"click",function(){Ze(o[21](o[60],o[52].category))&&o[21](o[60],o[52].category).apply(this,arguments)}),s=!0)},p(f,a){o=f;const u={};a[0]&4&&(u.value=o[60].id),a[0]&4&&(u.class=(o[60].nameEN===o[52].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-needs-foreground dark:data-[state=on]:bg-needs-foreground max-w-[300px]"),a[0]&4100|a[2]&2&&(u.$$scope={dirty:a,ctx:o}),l.$set(u),(!n||a[0]&1028&&r!==(r=(o[23](o[60],o[52])||o[10].needs.includes(o[60].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all"))&&F(e,"class",r)},i(f){n||(m(l.$$.fragment,f),n=!0)},o(f){_(l.$$.fragment,f),n=!1},d(f){f&&g(e),I(l),s=!1,i()}}}function Pe(o){let e,l,t=te(o[52].content),r=[];for(let s=0;s<t.length;s+=1)r[s]=Ue(ze(o,t,s));const n=s=>_(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ee()},l(s){for(let i=0;i<r.length;i+=1)r[i].l(s);e=ee()},m(s,i){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(s,i);w(s,e,i),l=!0},p(s,i){if(i[0]&10490884){t=te(s[52].content);let f;for(f=0;f<t.length;f+=1){const a=ze(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Ue(a),r[f].c(),m(r[f],1),r[f].m(e.parentNode,e))}for(R(),f=t.length;f<r.length;f+=1)n(f);K()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)_(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function hr(o){let e,l,t=o[2].length>0&&Le(o);return{c(){t&&t.c(),e=ee()},l(r){t&&t.l(r),e=ee()},m(r,n){t&&t.m(r,n),w(r,e,n),l=!0},p(r,n){r[2].length>0?t?(t.p(r,n),n[0]&4&&m(t,1)):(t=Le(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(R(),_(t,1,1,()=>{t=null}),K())},i(r){l||(m(t),l=!0)},o(r){_(t),l=!1},d(r){r&&g(e),t&&t.d(r)}}}function br(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[dr]},$$scope:{ctx:o}}});const s=[{type:"multiple"},o[48],{class:""}];function i(a){o[31](a)}let f={$$slots:{default:[hr]},$$scope:{ctx:o}};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].needs!==void 0&&(f.value=o[10].needs),t=new nt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[s[0],pe(a[48]),s[2]]):{};u[0]&5124|u[2]&2&&(h.$$scope={dirty:u,ctx:a}),!r&&u[0]&1024&&(r=!0,h.value=a[10].needs,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function vr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[br,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&7172|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function wr(o){let e=o[11]("default.page.fights.form.feelings.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.feelings.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Re(o){let e,l,t=te(o[1]),r=[];for(let s=0;s<t.length;s+=1)r[s]=Ge(Oe(o,t,s));const n=s=>_(r[s],1,1,()=>{r[s]=null});return{c(){e=V("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=y(s,"DIV",{class:!0});var i=j(e);for(let f=0;f<r.length;f+=1)r[f].l(i);i.forEach(g),this.h()},h(){F(e,"class","")},m(s,i){w(s,e,i);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);l=!0},p(s,i){if(i[0]&12590339){t=te(s[1]);let f;for(f=0;f<t.length;f+=1){const a=Oe(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Ge(a),r[f].c(),m(r[f],1),r[f].m(e,null))}for(R(),f=t.length;f<r.length;f+=1)n(f);K()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)_(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function kr(o){let e=(o[12]==="de"?o[55].nameDE:o[55].nameEN)+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&4098&&e!==(e=(t[12]==="de"?t[55].nameDE:t[55].nameEN)+"")&&x(l,e)},d(t){t&&g(l)}}}function Ke(o){let e,l,t,r,n,s;return l=new st({props:{value:o[55].id,class:(o[55].nameEN===o[52].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-feelings-foreground dark:data-[state=on]:bg-feelings-foreground max-w-[300px]",$$slots:{default:[kr]},$$scope:{ctx:o}}}),{c(){e=V("button"),k(l.$$.fragment),this.h()},l(i){e=y(i,"BUTTON",{type:!0,class:!0});var f=j(e);E(l.$$.fragment,f),f.forEach(g),this.h()},h(){F(e,"type","button"),F(e,"class",t=(o[23](o[55],o[52])||o[10].feelings.includes(o[55].id)?"pointer-events-auto max-w-[300px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all")},m(i,f){w(i,e,f),C(l,e,null),r=!0,n||(s=be(e,"click",function(){Ze(o[22](o[55],o[52].category))&&o[22](o[55],o[52].category).apply(this,arguments)}),n=!0)},p(i,f){o=i;const a={};f[0]&2&&(a.value=o[55].id),f[0]&2&&(a.class=(o[55].nameEN===o[52].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-feelings-foreground dark:data-[state=on]:bg-feelings-foreground max-w-[300px]"),f[0]&4098|f[2]&2&&(a.$$scope={dirty:f,ctx:o}),l.$set(a),(!r||f[0]&1026&&t!==(t=(o[23](o[55],o[52])||o[10].feelings.includes(o[55].id)?"pointer-events-auto max-w-[300px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all"))&&F(e,"class",t)},i(i){r||(m(l.$$.fragment,i),r=!0)},o(i){_(l.$$.fragment,i),r=!1},d(i){i&&g(e),I(l),n=!1,s()}}}function We(o){let e,l,t=te(o[52].content),r=[];for(let s=0;s<t.length;s+=1)r[s]=Ke(Me(o,t,s));const n=s=>_(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ee()},l(s){for(let i=0;i<r.length;i+=1)r[i].l(s);e=ee()},m(s,i){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(s,i);w(s,e,i),l=!0},p(s,i){if(i[0]&12588034){t=te(s[52].content);let f;for(f=0;f<t.length;f+=1){const a=Me(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Ke(a),r[f].c(),m(r[f],1),r[f].m(e.parentNode,e))}for(R(),f=t.length;f<r.length;f+=1)n(f);K()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)_(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function Ge(o){let e,l=(o[49].category==="true"?o[11]("default.page.fights.form.general.goodFeelings"):o[11]("default.page.fights.form.general.badFeelings"))+"",t,r,n,s,i,f,a,u,p,h=te(o[49].content),c=[];for(let d=0;d<h.length;d+=1)c[d]=We(Ae(o,h,d));const b=d=>_(c[d],1,1,()=>{c[d]=null});return{c(){e=V("div"),t=Y(l),r=J(),n=V("div"),f=J(),a=V("div");for(let d=0;d<c.length;d+=1)c[d].c();u=J(),this.h()},l(d){e=y(d,"DIV",{class:!0});var v=j(e);t=Z(v,l),r=q(v),n=y(v,"DIV",{class:!0}),j(n).forEach(g),v.forEach(g),f=q(d),a=y(d,"DIV",{class:!0});var T=j(a);for(let N=0;N<c.length;N+=1)c[N].l(T);u=q(T),T.forEach(g),this.h()},h(){F(n,"class",s="border-b border-"+o[8][o[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"),F(e,"class",i="text-"+o[8][o[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"),F(a,"class","-mx-1 flex w-full flex-wrap justify-start transition-all")},m(d,v){w(d,e,v),A(e,t),A(e,r),A(e,n),w(d,f,v),w(d,a,v);for(let T=0;T<c.length;T+=1)c[T]&&c[T].m(a,null);A(a,u),p=!0},p(d,v){if((!p||v[0]&2050)&&l!==(l=(d[49].category==="true"?d[11]("default.page.fights.form.general.goodFeelings"):d[11]("default.page.fights.form.general.badFeelings"))+"")&&x(t,l),(!p||v[0]&257&&s!==(s="border-b border-"+d[8][d[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"))&&F(n,"class",s),(!p||v[0]&257&&i!==(i="text-"+d[8][d[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"))&&F(e,"class",i),v[0]&12588034){h=te(d[49].content);let T;for(T=0;T<h.length;T+=1){const N=Ae(d,h,T);c[T]?(c[T].p(N,v),m(c[T],1)):(c[T]=We(N),c[T].c(),m(c[T],1),c[T].m(a,u))}for(R(),T=h.length;T<c.length;T+=1)b(T);K()}},i(d){if(!p){for(let v=0;v<h.length;v+=1)m(c[v]);p=!0}},o(d){c=c.filter(Boolean);for(let v=0;v<c.length;v+=1)_(c[v]);p=!1},d(d){d&&(g(e),g(f),g(a)),ve(c,d)}}}function Er(o){let e,l,t=o[1].length>0&&Re(o);return{c(){t&&t.c(),e=ee()},l(r){t&&t.l(r),e=ee()},m(r,n){t&&t.m(r,n),w(r,e,n),l=!0},p(r,n){r[1].length>0?t?(t.p(r,n),n[0]&2&&m(t,1)):(t=Re(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(R(),_(t,1,1,()=>{t=null}),K())},i(r){l||(m(t),l=!0)},o(r){_(t),l=!1},d(r){r&&g(e),t&&t.d(r)}}}function Cr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[wr]},$$scope:{ctx:o}}});const s=[{type:"multiple"},o[48],{class:"flex flex-col gap-4"}];function i(a){o[30](a)}let f={$$slots:{default:[Er]},$$scope:{ctx:o}};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].feelings!==void 0&&(f.value=o[10].feelings),t=new nt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[s[0],pe(a[48]),s[2]]):{};u[0]&7427|u[2]&2&&(h.$$scope={dirty:u,ctx:a}),!r&&u[0]&1024&&(r=!0,h.value=a[10].feelings,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function Ir(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Cr,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&7427|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function Sr(o){let e=o[11]("default.page.fights.form.observation.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.observation.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Br(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[Sr]},$$scope:{ctx:o}}});const s=[o[48],{class:"min-h-60"}];function i(a){o[28](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].observation!==void 0&&(f.value=o[10].observation),t=new lt({props:f}),le.push(()=>ae(t,"value",i)),t.$on("input",o[29]),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[pe(a[48]),s[1]]):{};!r&&u[0]&1024&&(r=!0,h.value=a[10].observation,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function Dr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Br,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&3136|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function Fr(o){let e=o[11]("default.page.fights.form.name.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.name.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Tr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label ",$$slots:{default:[Fr]},$$scope:{ctx:o}}});const s=[o[48]];function i(a){o[26](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].name!==void 0&&(f.value=o[10].name),t=new tt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[pe(a[48])]):{};!r&&u[0]&1024&&(r=!0,h.value=a[10].name,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function Nr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Tr,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&3072|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function Vr(o){let e=o[11]("default.page.fights.form.title.label")+"",l;return{c(){l=Y(e)},l(t){l=Z(t,e)},m(t,r){w(t,l,r)},p(t,r){r[0]&2048&&e!==(e=t[11]("default.page.fights.form.title.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function yr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label ",$$slots:{default:[Vr]},$$scope:{ctx:o}}});const s=[o[48]];function i(a){o[27](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[10].title!==void 0&&(f.value=o[10].title),t=new tt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=q(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),w(a,l,u),C(t,a,u),n=!0},p(a,u){const p={};u[0]&2048|u[2]&2&&(p.$$scope={dirty:u,ctx:a}),e.$set(p);const h=u[1]&131072?ge(s,[pe(a[48])]):{};!r&&u[0]&1024&&(r=!0,h.value=a[10].title,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),n=!1},d(a){a&&g(l),I(e,a),I(t,a)}}}function Jr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[yr,({attrs:n})=>({48:n}),({attrs:n})=>[0,n?131072:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=J(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=q(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),w(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&3072|s[1]&131072|s[2]&2&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),r=!1},d(n){n&&g(l),I(e,n),I(t,n)}}}function Qe(o){let e,l,t,r;const n=[mr,cr,ur,ir,fr,ar,or],s=[];function i(f,a){return f[0]===1?0:f[0]===2?1:f[0]===3?2:f[0]===4?3:f[4]?f[5]?5:6:4}return e=i(o),l=s[e]=n[e](o),{c(){l.c(),t=ee()},l(f){l.l(f),t=ee()},m(f,a){s[e].m(f,a),w(f,t,a),r=!0},p(f,a){let u=e;e=i(f),e===u?s[e].p(f,a):(R(),_(s[u],1,1,()=>{s[u]=null}),K(),l=s[e],l?l.p(f,a):(l=s[e]=n[e](f),l.c()),m(l,1),l.m(t.parentNode,t))},i(f){r||(m(l),r=!0)},o(f){_(l),r=!1},d(f){f&&g(t),s[e].d(f)}}}function jr(o){let e,l;return e=new et({props:{$$slots:{default:[zr]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&128|r[2]&2&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function qr(o){let e,l;return e=new et({props:{$$slots:{default:[Or]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&577|r[2]&2&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function zr(o){let e,l;return e=new Kt({props:{id:o[7]}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&128&&(n.id=t[7]),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function Or(o){let e,l;return e=new er({props:{step:o[0],checkForJudgement:o[6],primaryButtonClass:o[9],class:"flex-shrink-0"}}),e.$on("validateObservation",o[14]),e.$on("disableJudgementCheck",o[15]),e.$on("toPrev",o[19]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.step=t[0]),r[0]&64&&(n.checkForJudgement=t[6]),r[0]&512&&(n.primaryButtonClass=t[9]),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){_(e.$$.fragment,t),l=!1},d(t){I(e,t)}}}function Ar(o){let e,l,t,r,n,s,i,f,a,u=o[0],p,h,c,b,d,v,T;l=new Jt({});let N=!o[4]&&!o[5]&&He(o);function he(B){o[25](B)}let fe={speechBubbleContentArray:o[13],step:o[0],stepName:o[8][o[0]-1].slug,formSuccess:o[5]};o[3]!==void 0&&(fe.checkJudgement=o[3]),i=new sr({props:fe}),le.push(()=>ae(i,"checkJudgement",he));let S=Qe(o);const Q=[qr,jr],L=[];function W(B,D){return!B[4]&&!B[5]?0:1}return h=W(o),c=L[h]=Q[h](o),{c(){e=V("div"),k(l.$$.fragment),t=J(),r=V("div"),n=V("form"),N&&N.c(),s=J(),k(i.$$.fragment),a=J(),S.c(),p=J(),c.c(),this.h()},l(B){e=y(B,"DIV",{class:!0});var D=j(e);E(l.$$.fragment,D),t=q(D),r=y(D,"DIV",{class:!0});var U=j(r);n=y(U,"FORM",{class:!0});var P=j(n);N&&N.l(P),s=q(P),E(i.$$.fragment,P),a=q(P),S.l(P),p=q(P),c.l(P),P.forEach(g),U.forEach(g),D.forEach(g),this.h()},h(){F(n,"class","-mt-1 flex h-full flex-grow flex-col pb-[74px]"),F(r,"class","max-container relative flex flex-grow flex-col pb-40"),F(e,"class",b="flex flex-grow flex-col justify-between transition duration-500 "+o[9]+" dark:bg-background min-h-svh overflow-hidden")},m(B,D){w(B,e,D),C(l,e,null),A(e,t),A(e,r),A(r,n),N&&N.m(n,null),A(n,s),C(i,n,null),A(n,a),S.m(n,null),A(n,p),L[h].m(n,null),d=!0,v||(T=[be(n,"submit",Bt(o[24])),Dt(o[18].call(null,n))],v=!0)},p(B,D){!B[4]&&!B[5]?N?(N.p(B,D),D[0]&48&&m(N,1)):(N=He(B),N.c(),m(N,1),N.m(n,s)):N&&(R(),_(N,1,1,()=>{N=null}),K());const U={};D[0]&1&&(U.step=B[0]),D[0]&257&&(U.stepName=B[8][B[0]-1].slug),D[0]&32&&(U.formSuccess=B[5]),!f&&D[0]&8&&(f=!0,U.checkJudgement=B[3],oe(()=>f=!1)),i.$set(U),D[0]&1&&ke(u,u=B[0])?(R(),_(S,1,1,X),K(),S=Qe(B),S.c(),m(S,1),S.m(n,p)):S.p(B,D);let P=h;h=W(B),h===P?L[h].p(B,D):(R(),_(L[P],1,1,()=>{L[P]=null}),K(),c=L[h],c?c.p(B,D):(c=L[h]=Q[h](B),c.c()),m(c,1),c.m(n,null)),(!d||D[0]&512&&b!==(b="flex flex-grow flex-col justify-between transition duration-500 "+B[9]+" dark:bg-background min-h-svh overflow-hidden"))&&F(e,"class",b)},i(B){d||(m(l.$$.fragment,B),m(N),m(i.$$.fragment,B),m(S),m(c),d=!0)},o(B){_(l.$$.fragment,B),_(N),_(i.$$.fragment,B),_(S),_(c),d=!1},d(B){B&&g(e),I(l),N&&N.d(),I(i),S.d(B),L[h].d(),v=!1,Ye(T)}}}function Mr(o,e,l){let t,r,n,s,i;ue(o,Vt,$=>l(34,n=$)),ue(o,H,$=>l(11,s=$)),ue(o,xe,$=>l(12,i=$));const f=Mt(se(ie));let a=[],u=[],p;const h=[se(Ie),se(Se),se(Be),se(De),se(ie)];let c=1,b=!1,d=!1,v=!1,T;const N=$=>{const z=`bg-${we[$-1].slug}-background`;return yt.set(z),z},he=[{step:1,content:[s("default.page.fight.create.info")]},{step:2,content:[s("default.page.fight.create.observation")]},{step:3,content:[s("default.page.fight.create.feelings")]},{step:4,content:[s("default.page.fight.create.needs")]},{step:5,content:[s("default.page.fight.create.request")]},{step:6,content:[s("default.page.fight.create.success")],errorContent:[s("default.page.fight.create.error")]}],fe=async()=>{try{let $=r;$.owner=n.id,console.log("submit form",$);const z=await Ce.collection("fights").create($);l(7,T=z.id),l(5,d=!0),l(4,b=!0)}catch($){console.log("error handling submit",$),l(5,d=!1),l(4,b=!0)}},S=async $=>{const O=Object.keys(se([Ie,Se,Be,De,ie][$-1]).constraints);let M=!0;for(const ne of O)await at(ne,{update:!1})&&(M=!1);return!!M},Q=async()=>{const $=await Ve(ie);return $.valid?!0:(U.set($.errors),!1)},L=async()=>{const $=await Ve(ie);return $.errors.observation?(U.set($.errors),!1):(W(),!0)},W=()=>{p(r.observation),l(6,v=!1)},B=At(f,{resetForm:!1,validators:jt(ie),async onSubmit({validators:$,cancel:z}){console.log("onSubmit"),z(),await Q()&&(c==h.length&&fe(),l(0,c++,c))},async onUpdated({form:$}){console.log("onUpdated"),$.valid&&l(0,c=1)}}),{form:D,errors:U,message:P,enhance:ot,validate:at,validateForm:Ve,options:ft,updateForm:Hr}=B;ue(o,D,$=>l(10,r=$)),D.subscribe($=>{console.log("form was updated",$)});let we=[{slug:"info",name:G(H)("default.page.fights.form.general.steps.info"),icon:Lt,invertedTextColor:!1,hidden:!1},{slug:"observation",name:G(H)("default.page.fights.form.general.steps.observation"),icon:Ut,invertedTextColor:!0,hidden:!1},{slug:"feelings",name:G(H)("default.page.fights.form.general.steps.feelings"),icon:Pt,invertedTextColor:!1,hidden:!1},{slug:"needs",name:G(H)("default.page.fights.form.general.steps.needs"),icon:Rt,invertedTextColor:!1,hidden:!1},{slug:"request",name:G(H)("default.page.fights.form.general.steps.request"),icon:Je,invertedTextColor:!1,hidden:!1},{slug:"success",name:G(H)("default.page.fights.form.general.steps.success"),icon:Je,invertedTextColor:!1,hidden:!0}];H.subscribe($=>{const z=we.map(O=>{const M=$(`default.page.fights.form.general.steps.${O.slug}`);return O.name=M,O});l(8,we=[...z])});const it=()=>{console.log("decreaseStep"),c>1&&(console.log("step",c),l(0,c=c-1),console.log("step",c))},ut=async()=>{const $=await Ce.collection("feelings").getFullList({sort:"category"}),z=ye($);let O=Ee(z,"positive");O.map(M=>(M.content=Ee(M.content,"category"),M.content.map(ne=>ne.visible=!1),M)),console.log("res",O),l(1,a=O)},ct=async()=>{const $=await Ce.collection("needs").getFullList({sort:"category"}),z=ye($);let O=Ee(z,"category");O.map(M=>M.visible=!1),console.log("res",O),l(2,u=O)},mt=async $=>{console.log("changeStep");const z=$.detail.step,O=await S(z);console.log("targetStepIsValid",O),O&&l(0,c=z)},gt=($,z)=>{if($.nameEN!==z)return;const O=u.find(M=>M.category===z);O&&(O.visible=!O.visible),l(2,u=[...u])},pt=($,z)=>{if($.nameEN!==z)return;const O=a[0].content.find(ne=>ne.category===z),M=a[1].content.find(ne=>ne.category===z);O&&(O.visible=!O.visible),M&&(M.visible=!M.visible),l(1,a=[...a])},_t=($,z)=>{const O=$.nameEN,M=z.category;return!!(O===M||z.visible)};Ft(async()=>{await ut(),await ct()});function dt($){Tt.call(this,o,$)}function $t($){p=$,l(3,p)}function ht($){o.$$.not_equal(r.name,$)&&(r.name=$,D.set(r))}function bt($){o.$$.not_equal(r.title,$)&&(r.title=$,D.set(r))}function vt($){o.$$.not_equal(r.observation,$)&&(r.observation=$,D.set(r))}const wt=()=>l(6,v=!0);function kt($){o.$$.not_equal(r.feelings,$)&&(r.feelings=$,D.set(r))}function Et($){o.$$.not_equal(r.needs,$)&&(r.needs=$,D.set(r))}function Ct($){o.$$.not_equal(r.request,$)&&(r.request=$,D.set(r))}return o.$$.update=()=>{o.$$.dirty[0]&1,o.$$.dirty[0]&1&&(ft.validators=h[c-1]),o.$$.dirty[0]&1&&l(9,t=N(c))},[c,a,u,p,b,d,v,T,we,t,r,s,i,he,L,W,B,D,ot,it,mt,gt,pt,_t,dt,$t,ht,bt,vt,wt,kt,Et,Ct]}class ol extends Fe{constructor(e){super(),Te(this,e,Mr,Ar,ke,{},null,[-1,-1,-1])}}export{ol as component};
