import{I as J,s as Ue,e as M,a as T,c as O,b as z,g as B,f as p,y as V,i as b,h as A,C as ke,S as ot,J as nt,D as st,k as pe,G as at,O as R,n as ee,p as ft,t as H,d as K,l as re,K as oe,L as ne,j as Y,M as se,T as Le}from"../chunks/scheduler.gWKEXFbz.js";import{S as it,i as ut,c as E,a as S,m as I,t as c,b as g,e as L,d as F,g as P,f as ae}from"../chunks/index.CG0cexN_.js";import{e as G}from"../chunks/index.cH0IdTE4.js";import{t as U,u as ct,l as mt,g as fe,a as ie}from"../chunks/page.BfOfo_9B.js";import{A as gt}from"../chunks/AppTopMenu.C_y8wpbh.js";import{A as pt}from"../chunks/AppBottomMenu.Bl4_HKxc.js";import{c as x,z as _t,F as ue,C as ce,a as me,b as ge}from"../chunks/zod.CS4Ln7Cw.js";import{I as $t}from"../chunks/input.CyatNRu3.js";import{M as dt,F as ht,a as bt,T as Pe,b as Je,c as Re}from"../chunks/Mascot.2tFHgHyG.js";import"../chunks/entry.CWnlcbln.js";import{z as X,s as vt}from"../chunks/memoize.CCA0v6Fo.js";import{d as wt}from"../chunks/defaults.CEskAMGU.js";import{I as kt}from"../chunks/icon-folder.CBGieXVr.js";import{I as Et,a as St,b as It,c as Ft}from"../chunks/icon-steps.dGSELuxl.js";import{p as $e}from"../chunks/pocketbase.Ce4YzWbP.js";import{s as Ee,g as de}from"../chunks/Avatar.Dh95kRus.js";const he=X.object({name:X.string().min(3,{message:J(U)("default.page.fights.form.name.tooShortError")})}),be=he.extend({observation:X.string().min(10,{message:J(U)("default.page.fights.form.observation.tooShortError")})}),ve=be.extend({feelings:X.array(X.string()).min(1,{message:J(U)("default.page.fights.form.feelings.tooFewError")})}),we=ve.extend({needs:X.array(X.string()).min(1,{message:J(U)("default.page.fights.form.needs.tooFewError")})}),le=we.extend({request:X.string().min(10,{message:J(U)("default.page.fights.form.request.tooFewError")})});function Se(n,t,r){const e=n.slice();return e[41]=t[r],e}function Ie(n,t,r){const e=n.slice();return e[49]=t[r],e}function Fe(n,t,r){const e=n.slice();return e[38]=t[r],e}function Ne(n,t,r){const e=n.slice();return e[41]=t[r],e}function De(n,t,r){const e=n.slice();return e[44]=t[r],e}function Ve(n){let t,r;return t=new ht({props:{step:n[0],steps:n[5],stepBackground:n[5][n[0]-1].slug}}),t.$on("changeStep",n[13]),{c(){E(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,l){I(t,e,l),r=!0},p(e,l){const o={};l[0]&1&&(o.step=e[0]),l[0]&32&&(o.steps=e[5]),l[0]&33&&(o.stepBackground=e[5][e[0]-1].slug),t.$set(o)},i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){g(t.$$.fragment,e),r=!1},d(e){F(t,e)}}}function Nt(n){let t;return{c(){t=H("Error in Submit")},l(r){t=K(r,"Error in Submit")},m(r,e){b(r,t,e)},p:ee,i:ee,o:ee,d(r){r&&p(t)}}}function Dt(n){let t;return{c(){t=H("Success")},l(r){t=K(r,"Success")},m(r,e){b(r,t,e)},p:ee,i:ee,o:ee,d(r){r&&p(t)}}}function Vt(n){let t,r,e;return r=new ue({props:{form:n[9],name:"request",$$slots:{default:[Ot]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(r.$$.fragment),this.h()},l(l){t=O(l,"DIV",{class:!0});var o=z(t);S(r.$$.fragment,o),o.forEach(p),this.h()},h(){V(t,"class","form-content")},m(l,o){b(l,t,o),I(r,t,null),e=!0},p(l,o){const s={};o[0]&192|o[1]&2097152&&(s.$$scope={dirty:o,ctx:l}),r.$set(s)},i(l){e||(c(r.$$.fragment,l),e=!0)},o(l){g(r.$$.fragment,l),e=!1},d(l){l&&p(t),F(r)}}}function qt(n){let t,r,e;return r=new ue({props:{form:n[9],name:"needs",$$slots:{default:[Pt]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(r.$$.fragment),this.h()},l(l){t=O(l,"DIV",{class:!0});var o=z(t);S(r.$$.fragment,o),o.forEach(p),this.h()},h(){V(t,"class","form-content")},m(l,o){b(l,t,o),I(r,t,null),e=!0},p(l,o){const s={};o[0]&452|o[1]&2097152&&(s.$$scope={dirty:o,ctx:l}),r.$set(s)},i(l){e||(c(r.$$.fragment,l),e=!0)},o(l){g(r.$$.fragment,l),e=!1},d(l){l&&p(t),F(r)}}}function Ct(n){let t,r,e;return r=new ue({props:{form:n[9],name:"feelings",$$slots:{default:[Kt]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(r.$$.fragment),this.h()},l(l){t=O(l,"DIV",{class:!0});var o=z(t);S(r.$$.fragment,o),o.forEach(p),this.h()},h(){V(t,"class","form-content")},m(l,o){b(l,t,o),I(r,t,null),e=!0},p(l,o){const s={};o[0]&483|o[1]&2097152&&(s.$$scope={dirty:o,ctx:l}),r.$set(s)},i(l){e||(c(r.$$.fragment,l),e=!0)},o(l){g(r.$$.fragment,l),e=!1},d(l){l&&p(t),F(r)}}}function Tt(n){let t,r,e;return r=new ue({props:{form:n[9],name:"observation",$$slots:{default:[Xt]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(r.$$.fragment),this.h()},l(l){t=O(l,"DIV",{class:!0});var o=z(t);S(r.$$.fragment,o),o.forEach(p),this.h()},h(){V(t,"class","form-content")},m(l,o){b(l,t,o),I(r,t,null),e=!0},p(l,o){const s={};o[0]&192|o[1]&2097152&&(s.$$scope={dirty:o,ctx:l}),r.$set(s)},i(l){e||(c(r.$$.fragment,l),e=!0)},o(l){g(r.$$.fragment,l),e=!1},d(l){l&&p(t),F(r)}}}function Bt(n){let t,r,e;return r=new ue({props:{form:n[9],name:"name",$$slots:{default:[yt]},$$scope:{ctx:n}}}),{c(){t=M("div"),E(r.$$.fragment),this.h()},l(l){t=O(l,"DIV",{class:!0});var o=z(t);S(r.$$.fragment,o),o.forEach(p),this.h()},h(){V(t,"class","form-content")},m(l,o){b(l,t,o),I(r,t,null),e=!0},p(l,o){const s={};o[0]&192|o[1]&2097152&&(s.$$scope={dirty:o,ctx:l}),r.$set(s)},i(l){e||(c(r.$$.fragment,l),e=!0)},o(l){g(r.$$.fragment,l),e=!1},d(l){l&&p(t),F(r)}}}function jt(n){let t=n[7]("default.page.fights.form.request.label")+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&128&&t!==(t=e[7]("default.page.fights.form.request.label")+"")&&Y(r,t)},d(e){e&&p(r)}}}function Mt(n){let t,r,e,l,o;t=new ge({props:{class:"form-label",$$slots:{default:[jt]},$$scope:{ctx:n}}});const s=[n[37],{class:"min-h-60"}];function i(a){n[22](a)}let f={};for(let a=0;a<s.length;a+=1)f=re(f,s[a]);return n[6].request!==void 0&&(f.value=n[6].request),e=new Pe({props:f}),oe.push(()=>ae(e,"value",i)),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(a){S(t.$$.fragment,a),r=B(a),S(e.$$.fragment,a)},m(a,u){I(t,a,u),b(a,r,u),I(e,a,u),o=!0},p(a,u){const $={};u[0]&128|u[1]&2097152&&($.$$scope={dirty:u,ctx:a}),t.$set($);const k=u[1]&64?fe(s,[ie(a[37]),s[1]]):{};!l&&u[0]&64&&(l=!0,k.value=a[6].request,ne(()=>l=!1)),e.$set(k)},i(a){o||(c(t.$$.fragment,a),c(e.$$.fragment,a),o=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),o=!1},d(a){a&&p(r),F(t,a),F(e,a)}}}function Ot(n){let t,r,e,l;return t=new ce({props:{$$slots:{default:[Mt,({attrs:o})=>({37:o}),({attrs:o})=>[0,o?64:0]]},$$scope:{ctx:n}}}),e=new me({}),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(o){S(t.$$.fragment,o),r=B(o),S(e.$$.fragment,o)},m(o,s){I(t,o,s),b(o,r,s),I(e,o,s),l=!0},p(o,s){const i={};s[0]&192|s[1]&2097216&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){l||(c(t.$$.fragment,o),c(e.$$.fragment,o),l=!0)},o(o){g(t.$$.fragment,o),g(e.$$.fragment,o),l=!1},d(o){o&&p(r),F(t,o),F(e,o)}}}function zt(n){let t=n[7]("default.page.fights.form.needs.label")+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&128&&t!==(t=e[7]("default.page.fights.form.needs.label")+"")&&Y(r,t)},d(e){e&&p(r)}}}function qe(n){let t,r,e=G(n[2]),l=[];for(let s=0;s<e.length;s+=1)l[s]=Te(Se(n,e,s));const o=s=>g(l[s],1,1,()=>{l[s]=null});return{c(){t=M("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){t=O(s,"DIV",{class:!0});var i=z(t);for(let f=0;f<l.length;f+=1)l[f].l(i);i.forEach(p),this.h()},h(){V(t,"class","-m-1 flex w-full flex-wrap justify-start transition-all")},m(s,i){b(s,t,i);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(t,null);r=!0},p(s,i){if(i[0]&82244){e=G(s[2]);let f;for(f=0;f<e.length;f+=1){const a=Se(s,e,f);l[f]?(l[f].p(a,i),c(l[f],1)):(l[f]=Te(a),l[f].c(),c(l[f],1),l[f].m(t,null))}for(P(),f=e.length;f<l.length;f+=1)o(f);L()}},i(s){if(!r){for(let i=0;i<e.length;i+=1)c(l[i]);r=!0}},o(s){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)g(l[i]);r=!1},d(s){s&&p(t),se(l,s)}}}function At(n){let t=(n[8]==="de"?n[49].nameDE:n[49].nameEN)+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&260&&t!==(t=(e[8]==="de"?e[49].nameDE:e[49].nameEN)+"")&&Y(r,t)},d(e){e&&p(r)}}}function Ce(n){let t,r,e,l,o,s,i;return r=new Re({props:{value:n[49].id,class:(n[49].nameEN===n[41].category?"bg-white/40 font-bold":"border border-white/40")+" py-0 text-black  shadow hover:text-black data-[state=on]:bg-needs-foreground data-[state=on]:text-white dark:text-white dark:hover:bg-black/20",$$slots:{default:[At]},$$scope:{ctx:n}}}),{c(){t=M("button"),E(r.$$.fragment),e=T(),this.h()},l(f){t=O(f,"BUTTON",{type:!0,class:!0});var a=z(t);S(r.$$.fragment,a),e=B(a),a.forEach(p),this.h()},h(){V(t,"type","button"),V(t,"class",l=(n[16](n[49],n[41])||n[6].needs.includes(n[49].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all")},m(f,a){b(f,t,a),I(r,t,null),A(t,e),o=!0,s||(i=ke(t,"click",function(){Le(n[14](n[49],n[41].category))&&n[14](n[49],n[41].category).apply(this,arguments)}),s=!0)},p(f,a){n=f;const u={};a[0]&4&&(u.value=n[49].id),a[0]&4&&(u.class=(n[49].nameEN===n[41].category?"bg-white/40 font-bold":"border border-white/40")+" py-0 text-black  shadow hover:text-black data-[state=on]:bg-needs-foreground data-[state=on]:text-white dark:text-white dark:hover:bg-black/20"),a[0]&260|a[1]&2097152&&(u.$$scope={dirty:a,ctx:n}),r.$set(u),(!o||a[0]&68&&l!==(l=(n[16](n[49],n[41])||n[6].needs.includes(n[49].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all"))&&V(t,"class",l)},i(f){o||(c(r.$$.fragment,f),o=!0)},o(f){g(r.$$.fragment,f),o=!1},d(f){f&&p(t),F(r),s=!1,i()}}}function Te(n){let t,r,e=G(n[41].content),l=[];for(let s=0;s<e.length;s+=1)l[s]=Ce(Ie(n,e,s));const o=s=>g(l[s],1,1,()=>{l[s]=null});return{c(){for(let s=0;s<l.length;s+=1)l[s].c();t=R()},l(s){for(let i=0;i<l.length;i+=1)l[i].l(s);t=R()},m(s,i){for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(s,i);b(s,t,i),r=!0},p(s,i){if(i[0]&82244){e=G(s[41].content);let f;for(f=0;f<e.length;f+=1){const a=Ie(s,e,f);l[f]?(l[f].p(a,i),c(l[f],1)):(l[f]=Ce(a),l[f].c(),c(l[f],1),l[f].m(t.parentNode,t))}for(P(),f=e.length;f<l.length;f+=1)o(f);L()}},i(s){if(!r){for(let i=0;i<e.length;i+=1)c(l[i]);r=!0}},o(s){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)g(l[i]);r=!1},d(s){s&&p(t),se(l,s)}}}function Ut(n){let t,r,e=n[2].length>0&&qe(n);return{c(){e&&e.c(),t=R()},l(l){e&&e.l(l),t=R()},m(l,o){e&&e.m(l,o),b(l,t,o),r=!0},p(l,o){l[2].length>0?e?(e.p(l,o),o[0]&4&&c(e,1)):(e=qe(l),e.c(),c(e,1),e.m(t.parentNode,t)):e&&(P(),g(e,1,1,()=>{e=null}),L())},i(l){r||(c(e),r=!0)},o(l){g(e),r=!1},d(l){l&&p(t),e&&e.d(l)}}}function Lt(n){let t,r,e,l,o;t=new ge({props:{class:"form-label",$$slots:{default:[zt]},$$scope:{ctx:n}}});const s=[{type:"multiple"},n[37],{class:""}];function i(a){n[21](a)}let f={$$slots:{default:[Ut]},$$scope:{ctx:n}};for(let a=0;a<s.length;a+=1)f=re(f,s[a]);return n[6].needs!==void 0&&(f.value=n[6].needs),e=new Je({props:f}),oe.push(()=>ae(e,"value",i)),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(a){S(t.$$.fragment,a),r=B(a),S(e.$$.fragment,a)},m(a,u){I(t,a,u),b(a,r,u),I(e,a,u),o=!0},p(a,u){const $={};u[0]&128|u[1]&2097152&&($.$$scope={dirty:u,ctx:a}),t.$set($);const k=u[1]&64?fe(s,[s[0],ie(a[37]),s[2]]):{};u[0]&324|u[1]&2097152&&(k.$$scope={dirty:u,ctx:a}),!l&&u[0]&64&&(l=!0,k.value=a[6].needs,ne(()=>l=!1)),e.$set(k)},i(a){o||(c(t.$$.fragment,a),c(e.$$.fragment,a),o=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),o=!1},d(a){a&&p(r),F(t,a),F(e,a)}}}function Pt(n){let t,r,e,l;return t=new ce({props:{$$slots:{default:[Lt,({attrs:o})=>({37:o}),({attrs:o})=>[0,o?64:0]]},$$scope:{ctx:n}}}),e=new me({}),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(o){S(t.$$.fragment,o),r=B(o),S(e.$$.fragment,o)},m(o,s){I(t,o,s),b(o,r,s),I(e,o,s),l=!0},p(o,s){const i={};s[0]&452|s[1]&2097216&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){l||(c(t.$$.fragment,o),c(e.$$.fragment,o),l=!0)},o(o){g(t.$$.fragment,o),g(e.$$.fragment,o),l=!1},d(o){o&&p(r),F(t,o),F(e,o)}}}function Jt(n){let t=n[7]("default.page.fights.form.feelings.label")+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&128&&t!==(t=e[7]("default.page.fights.form.feelings.label")+"")&&Y(r,t)},d(e){e&&p(r)}}}function Be(n){let t,r,e=G(n[1]),l=[];for(let s=0;s<e.length;s+=1)l[s]=Oe(Fe(n,e,s));const o=s=>g(l[s],1,1,()=>{l[s]=null});return{c(){t=M("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){t=O(s,"DIV",{class:!0});var i=z(t);for(let f=0;f<l.length;f+=1)l[f].l(i);i.forEach(p),this.h()},h(){V(t,"class","")},m(s,i){b(s,t,i);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(t,null);r=!0},p(s,i){if(i[0]&98787){e=G(s[1]);let f;for(f=0;f<e.length;f+=1){const a=Fe(s,e,f);l[f]?(l[f].p(a,i),c(l[f],1)):(l[f]=Oe(a),l[f].c(),c(l[f],1),l[f].m(t,null))}for(P(),f=e.length;f<l.length;f+=1)o(f);L()}},i(s){if(!r){for(let i=0;i<e.length;i+=1)c(l[i]);r=!0}},o(s){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)g(l[i]);r=!1},d(s){s&&p(t),se(l,s)}}}function Rt(n){let t=(n[8]==="de"?n[44].nameDE:n[44].nameEN)+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&258&&t!==(t=(e[8]==="de"?e[44].nameDE:e[44].nameEN)+"")&&Y(r,t)},d(e){e&&p(r)}}}function je(n){let t,r,e,l,o,s;return r=new Re({props:{value:n[44].id,class:(n[44].nameEN===n[41].category?"bg-white/40 font-bold":"border border-white/40")+" py-0 text-black  shadow hover:text-black data-[state=on]:bg-feelings-foreground data-[state=on]:text-white dark:text-white dark:hover:bg-black/20",$$slots:{default:[Rt]},$$scope:{ctx:n}}}),{c(){t=M("button"),E(r.$$.fragment),this.h()},l(i){t=O(i,"BUTTON",{type:!0,class:!0});var f=z(t);S(r.$$.fragment,f),f.forEach(p),this.h()},h(){V(t,"type","button"),V(t,"class",e=(n[16](n[44],n[41])||n[6].feelings.includes(n[44].id)?"pointer-events-auto max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all")},m(i,f){b(i,t,f),I(r,t,null),l=!0,o||(s=ke(t,"click",function(){Le(n[15](n[44],n[41].category))&&n[15](n[44],n[41].category).apply(this,arguments)}),o=!0)},p(i,f){n=i;const a={};f[0]&2&&(a.value=n[44].id),f[0]&2&&(a.class=(n[44].nameEN===n[41].category?"bg-white/40 font-bold":"border border-white/40")+" py-0 text-black  shadow hover:text-black data-[state=on]:bg-feelings-foreground data-[state=on]:text-white dark:text-white dark:hover:bg-black/20"),f[0]&258|f[1]&2097152&&(a.$$scope={dirty:f,ctx:n}),r.$set(a),(!l||f[0]&66&&e!==(e=(n[16](n[44],n[41])||n[6].feelings.includes(n[44].id)?"pointer-events-auto max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all"))&&V(t,"class",e)},i(i){l||(c(r.$$.fragment,i),l=!0)},o(i){g(r.$$.fragment,i),l=!1},d(i){i&&p(t),F(r),o=!1,s()}}}function Me(n){let t,r,e=G(n[41].content),l=[];for(let s=0;s<e.length;s+=1)l[s]=je(De(n,e,s));const o=s=>g(l[s],1,1,()=>{l[s]=null});return{c(){for(let s=0;s<l.length;s+=1)l[s].c();t=R()},l(s){for(let i=0;i<l.length;i+=1)l[i].l(s);t=R()},m(s,i){for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(s,i);b(s,t,i),r=!0},p(s,i){if(i[0]&98626){e=G(s[41].content);let f;for(f=0;f<e.length;f+=1){const a=De(s,e,f);l[f]?(l[f].p(a,i),c(l[f],1)):(l[f]=je(a),l[f].c(),c(l[f],1),l[f].m(t.parentNode,t))}for(P(),f=e.length;f<l.length;f+=1)o(f);L()}},i(s){if(!r){for(let i=0;i<e.length;i+=1)c(l[i]);r=!0}},o(s){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)g(l[i]);r=!1},d(s){s&&p(t),se(l,s)}}}function Oe(n){let t,r=(n[38].category==="true"?n[7]("default.page.fights.form.general.goodFeelings"):n[7]("default.page.fights.form.general.badFeelings"))+"",e,l,o,s,i,f,a,u,$,k=G(n[38].content),w=[];for(let h=0;h<k.length;h+=1)w[h]=Me(Ne(n,k,h));const Z=h=>g(w[h],1,1,()=>{w[h]=null});return{c(){t=M("div"),e=H(r),l=T(),o=M("div"),f=T(),a=M("div");for(let h=0;h<w.length;h+=1)w[h].c();u=T(),this.h()},l(h){t=O(h,"DIV",{class:!0});var _=z(t);e=K(_,r),l=B(_),o=O(_,"DIV",{class:!0}),z(o).forEach(p),_.forEach(p),f=B(h),a=O(h,"DIV",{class:!0});var d=z(a);for(let v=0;v<w.length;v+=1)w[v].l(d);u=B(d),d.forEach(p),this.h()},h(){V(o,"class",s="border-b border-"+n[5][n[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"),V(t,"class",i="text-"+n[5][n[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"),V(a,"class","-mx-1 flex w-full flex-wrap justify-start transition-all")},m(h,_){b(h,t,_),A(t,e),A(t,l),A(t,o),b(h,f,_),b(h,a,_);for(let d=0;d<w.length;d+=1)w[d]&&w[d].m(a,null);A(a,u),$=!0},p(h,_){if((!$||_[0]&130)&&r!==(r=(h[38].category==="true"?h[7]("default.page.fights.form.general.goodFeelings"):h[7]("default.page.fights.form.general.badFeelings"))+"")&&Y(e,r),(!$||_[0]&33&&s!==(s="border-b border-"+h[5][h[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"))&&V(o,"class",s),(!$||_[0]&33&&i!==(i="text-"+h[5][h[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"))&&V(t,"class",i),_[0]&98626){k=G(h[38].content);let d;for(d=0;d<k.length;d+=1){const v=Ne(h,k,d);w[d]?(w[d].p(v,_),c(w[d],1)):(w[d]=Me(v),w[d].c(),c(w[d],1),w[d].m(a,u))}for(P(),d=k.length;d<w.length;d+=1)Z(d);L()}},i(h){if(!$){for(let _=0;_<k.length;_+=1)c(w[_]);$=!0}},o(h){w=w.filter(Boolean);for(let _=0;_<w.length;_+=1)g(w[_]);$=!1},d(h){h&&(p(t),p(f),p(a)),se(w,h)}}}function Gt(n){let t,r,e=n[1].length>0&&Be(n);return{c(){e&&e.c(),t=R()},l(l){e&&e.l(l),t=R()},m(l,o){e&&e.m(l,o),b(l,t,o),r=!0},p(l,o){l[1].length>0?e?(e.p(l,o),o[0]&2&&c(e,1)):(e=Be(l),e.c(),c(e,1),e.m(t.parentNode,t)):e&&(P(),g(e,1,1,()=>{e=null}),L())},i(l){r||(c(e),r=!0)},o(l){g(e),r=!1},d(l){l&&p(t),e&&e.d(l)}}}function Ht(n){let t,r,e,l,o;t=new ge({props:{class:"form-label",$$slots:{default:[Jt]},$$scope:{ctx:n}}});const s=[{type:"multiple"},n[37],{class:"flex flex-col gap-4"}];function i(a){n[20](a)}let f={$$slots:{default:[Gt]},$$scope:{ctx:n}};for(let a=0;a<s.length;a+=1)f=re(f,s[a]);return n[6].feelings!==void 0&&(f.value=n[6].feelings),e=new Je({props:f}),oe.push(()=>ae(e,"value",i)),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(a){S(t.$$.fragment,a),r=B(a),S(e.$$.fragment,a)},m(a,u){I(t,a,u),b(a,r,u),I(e,a,u),o=!0},p(a,u){const $={};u[0]&128|u[1]&2097152&&($.$$scope={dirty:u,ctx:a}),t.$set($);const k=u[1]&64?fe(s,[s[0],ie(a[37]),s[2]]):{};u[0]&483|u[1]&2097152&&(k.$$scope={dirty:u,ctx:a}),!l&&u[0]&64&&(l=!0,k.value=a[6].feelings,ne(()=>l=!1)),e.$set(k)},i(a){o||(c(t.$$.fragment,a),c(e.$$.fragment,a),o=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),o=!1},d(a){a&&p(r),F(t,a),F(e,a)}}}function Kt(n){let t,r,e,l;return t=new ce({props:{$$slots:{default:[Ht,({attrs:o})=>({37:o}),({attrs:o})=>[0,o?64:0]]},$$scope:{ctx:n}}}),e=new me({}),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(o){S(t.$$.fragment,o),r=B(o),S(e.$$.fragment,o)},m(o,s){I(t,o,s),b(o,r,s),I(e,o,s),l=!0},p(o,s){const i={};s[0]&483|s[1]&2097216&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){l||(c(t.$$.fragment,o),c(e.$$.fragment,o),l=!0)},o(o){g(t.$$.fragment,o),g(e.$$.fragment,o),l=!1},d(o){o&&p(r),F(t,o),F(e,o)}}}function Qt(n){let t=n[7]("default.page.fights.form.observation.label")+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&128&&t!==(t=e[7]("default.page.fights.form.observation.label")+"")&&Y(r,t)},d(e){e&&p(r)}}}function Wt(n){let t,r,e,l,o;t=new ge({props:{class:"form-label",$$slots:{default:[Qt]},$$scope:{ctx:n}}});const s=[n[37],{class:"min-h-60"}];function i(a){n[19](a)}let f={};for(let a=0;a<s.length;a+=1)f=re(f,s[a]);return n[6].observation!==void 0&&(f.value=n[6].observation),e=new Pe({props:f}),oe.push(()=>ae(e,"value",i)),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(a){S(t.$$.fragment,a),r=B(a),S(e.$$.fragment,a)},m(a,u){I(t,a,u),b(a,r,u),I(e,a,u),o=!0},p(a,u){const $={};u[0]&128|u[1]&2097152&&($.$$scope={dirty:u,ctx:a}),t.$set($);const k=u[1]&64?fe(s,[ie(a[37]),s[1]]):{};!l&&u[0]&64&&(l=!0,k.value=a[6].observation,ne(()=>l=!1)),e.$set(k)},i(a){o||(c(t.$$.fragment,a),c(e.$$.fragment,a),o=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),o=!1},d(a){a&&p(r),F(t,a),F(e,a)}}}function Xt(n){let t,r,e,l;return t=new ce({props:{$$slots:{default:[Wt,({attrs:o})=>({37:o}),({attrs:o})=>[0,o?64:0]]},$$scope:{ctx:n}}}),e=new me({}),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(o){S(t.$$.fragment,o),r=B(o),S(e.$$.fragment,o)},m(o,s){I(t,o,s),b(o,r,s),I(e,o,s),l=!0},p(o,s){const i={};s[0]&192|s[1]&2097216&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){l||(c(t.$$.fragment,o),c(e.$$.fragment,o),l=!0)},o(o){g(t.$$.fragment,o),g(e.$$.fragment,o),l=!1},d(o){o&&p(r),F(t,o),F(e,o)}}}function Yt(n){let t=n[7]("default.page.fights.form.name.label")+"",r;return{c(){r=H(t)},l(e){r=K(e,t)},m(e,l){b(e,r,l)},p(e,l){l[0]&128&&t!==(t=e[7]("default.page.fights.form.name.label")+"")&&Y(r,t)},d(e){e&&p(r)}}}function Zt(n){let t,r,e,l,o;t=new ge({props:{class:"form-label ",$$slots:{default:[Yt]},$$scope:{ctx:n}}});const s=[n[37]];function i(a){n[18](a)}let f={};for(let a=0;a<s.length;a+=1)f=re(f,s[a]);return n[6].name!==void 0&&(f.value=n[6].name),e=new $t({props:f}),oe.push(()=>ae(e,"value",i)),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(a){S(t.$$.fragment,a),r=B(a),S(e.$$.fragment,a)},m(a,u){I(t,a,u),b(a,r,u),I(e,a,u),o=!0},p(a,u){const $={};u[0]&128|u[1]&2097152&&($.$$scope={dirty:u,ctx:a}),t.$set($);const k=u[1]&64?fe(s,[ie(a[37])]):{};!l&&u[0]&64&&(l=!0,k.value=a[6].name,ne(()=>l=!1)),e.$set(k)},i(a){o||(c(t.$$.fragment,a),c(e.$$.fragment,a),o=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),o=!1},d(a){a&&p(r),F(t,a),F(e,a)}}}function yt(n){let t,r,e,l;return t=new ce({props:{$$slots:{default:[Zt,({attrs:o})=>({37:o}),({attrs:o})=>[0,o?64:0]]},$$scope:{ctx:n}}}),e=new me({}),{c(){E(t.$$.fragment),r=T(),E(e.$$.fragment)},l(o){S(t.$$.fragment,o),r=B(o),S(e.$$.fragment,o)},m(o,s){I(t,o,s),b(o,r,s),I(e,o,s),l=!0},p(o,s){const i={};s[0]&192|s[1]&2097216&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){l||(c(t.$$.fragment,o),c(e.$$.fragment,o),l=!0)},o(o){g(t.$$.fragment,o),g(e.$$.fragment,o),l=!1},d(o){o&&p(r),F(t,o),F(e,o)}}}function ze(n){let t,r,e,l;const o=[Bt,Tt,Ct,qt,Vt,Dt,Nt],s=[];function i(f,a){return f[0]===1?0:f[0]===2?1:f[0]===3?2:f[0]===4?3:f[3]?f[4]?5:6:4}return t=i(n),r=s[t]=o[t](n),{c(){r.c(),e=R()},l(f){r.l(f),e=R()},m(f,a){s[t].m(f,a),b(f,e,a),l=!0},p(f,a){let u=t;t=i(f),t===u?s[t].p(f,a):(P(),g(s[u],1,1,()=>{s[u]=null}),L(),r=s[t],r?r.p(f,a):(r=s[t]=o[t](f),r.c()),c(r,1),r.m(e.parentNode,e))},i(f){l||(c(r),l=!0)},o(f){g(r),l=!1},d(f){f&&p(e),s[t].d(f)}}}function Ae(n){let t,r;return t=new pt({props:{$$slots:{default:[xt]},$$scope:{ctx:n}}}),{c(){E(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,l){I(t,e,l),r=!0},p(e,l){const o={};l[0]&33|l[1]&2097152&&(o.$$scope={dirty:l,ctx:e}),t.$set(o)},i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){g(t.$$.fragment,e),r=!1},d(e){F(t,e)}}}function xt(n){let t,r;return t=new bt({props:{step:n[0],primaryButtonClass:`bg-${n[5][n[0]-1].slug}-background`,class:"flex-shrink-0"}}),t.$on("toPrev",n[12]),{c(){E(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,l){I(t,e,l),r=!0},p(e,l){const o={};l[0]&1&&(o.step=e[0]),l[0]&33&&(o.primaryButtonClass=`bg-${e[5][e[0]-1].slug}-background`),t.$set(o)},i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){g(t.$$.fragment,e),r=!1},d(e){F(t,e)}}}function el(n){let t,r,e,l,o,s,i,f,a,u=n[0],$,k,w,Z,h;r=new gt({});let _=!n[3]&&!n[4]&&Ve(n);f=new dt({props:{step:n[0],stepName:n[5][n[0]-1].slug}});let d=ze(n),v=!n[3]&&!n[4]&&Ae(n);return{c(){t=M("div"),E(r.$$.fragment),e=T(),l=M("div"),o=M("form"),_&&_.c(),s=T(),i=M("div"),E(f.$$.fragment),a=T(),d.c(),$=T(),v&&v.c(),this.h()},l(N){t=O(N,"DIV",{class:!0});var j=z(t);S(r.$$.fragment,j),e=B(j),l=O(j,"DIV",{class:!0});var Q=z(l);o=O(Q,"FORM",{class:!0});var te=z(o);_&&_.l(te),s=B(te),i=O(te,"DIV",{class:!0});var W=z(i);S(f.$$.fragment,W),a=B(W),d.l(W),$=B(W),v&&v.l(W),W.forEach(p),te.forEach(p),Q.forEach(p),j.forEach(p),this.h()},h(){V(i,"class","relative z-0"),V(o,"class","-mt-1 flex h-full flex-grow flex-col pb-[74px]"),V(l,"class","max-container relative flex flex-grow flex-col pb-40"),V(t,"class",k=`flex flex-grow flex-col justify-between transition duration-700 bg-${n[5][n[0]-1].slug}-background`)},m(N,j){b(N,t,j),I(r,t,null),A(t,e),A(t,l),A(l,o),_&&_.m(o,null),A(o,s),A(o,i),I(f,i,null),A(i,a),d.m(i,null),A(i,$),v&&v.m(i,null),w=!0,Z||(h=[ke(o,"submit",ot(n[17])),nt(n[11].call(null,o))],Z=!0)},p(N,j){!N[3]&&!N[4]?_?(_.p(N,j),j[0]&24&&c(_,1)):(_=Ve(N),_.c(),c(_,1),_.m(o,s)):_&&(P(),g(_,1,1,()=>{_=null}),L());const Q={};j[0]&1&&(Q.step=N[0]),j[0]&33&&(Q.stepName=N[5][N[0]-1].slug),f.$set(Q),j[0]&1&&Ue(u,u=N[0])?(P(),g(d,1,1,ee),L(),d=ze(N),d.c(),c(d,1),d.m(i,$)):d.p(N,j),!N[3]&&!N[4]?v?(v.p(N,j),j[0]&24&&c(v,1)):(v=Ae(N),v.c(),c(v,1),v.m(i,null)):v&&(P(),g(v,1,1,()=>{v=null}),L()),(!w||j[0]&33&&k!==(k=`flex flex-grow flex-col justify-between transition duration-700 bg-${N[5][N[0]-1].slug}-background`))&&V(t,"class",k)},i(N){w||(c(r.$$.fragment,N),c(_),c(f.$$.fragment,N),c(d),c(v),w=!0)},o(N){g(r.$$.fragment,N),g(_),g(f.$$.fragment,N),g(d),g(v),w=!1},d(N){N&&p(t),F(r),_&&_.d(),F(f),d.d(N),v&&v.d(),Z=!1,st(h)}}}function tl(n,t,r){let e,l,o,s;pe(n,ct,m=>r(24,l=m)),pe(n,U,m=>r(7,o=m)),pe(n,mt,m=>r(8,s=m));const i=wt(x(le));let f=[],a=[];const u=[x(he),x(be),x(ve),x(we),x(le)];let $=1,k=!1,w=!1;const Z=async()=>{try{let m=e;m.owner=l.id,console.log("submit form",m);const q=await $e.collection("fights").create(m);r(4,w=!0),r(3,k=!0)}catch(m){console.log("error handling submit",m),r(4,w=!1),r(3,k=!0)}},h=async m=>{const D=Object.keys(x([he,be,ve,we,le][m-1]).constraints);let C=!0;for(const y of D)await te(y,{update:!1})&&(C=!1);return!!C},_=async()=>{const m=await W(e,le);return m.valid?!0:(N.set(m.errors),!1)},d=vt(i,{resetForm:!1,validators:_t(le),async onSubmit({validators:m,cancel:q}){console.log("onSubmit"),q(),await _()&&($==u.length?Z():r(0,$++,$))},async onUpdated({form:m}){console.log("onUpdated"),m.valid&&r(0,$=1)}}),{form:v,errors:N,message:j,enhance:Q,validate:te,validateForm:W,options:Ge,updateForm:ll}=d;pe(n,v,m=>r(6,e=m)),v.subscribe(m=>{console.log("form was updated",m)});let _e=[{slug:"info",name:J(U)("default.page.fights.form.general.steps.info"),icon:kt,invertedTextColor:!1},{slug:"observation",name:J(U)("default.page.fights.form.general.steps.observation"),icon:Et,invertedTextColor:!0},{slug:"feelings",name:J(U)("default.page.fights.form.general.steps.feelings"),icon:St,invertedTextColor:!1},{slug:"needs",name:J(U)("default.page.fights.form.general.steps.needs"),icon:It,invertedTextColor:!1},{slug:"request",name:J(U)("default.page.fights.form.general.steps.request"),icon:Ft,invertedTextColor:!1}];U.subscribe(m=>{const q=_e.map(D=>{const C=m(`default.page.fights.form.general.steps.${D.slug}`);return D.name=C,D});r(5,_e=[...q])});const He=()=>{console.log("decreaseStep"),$>1&&(console.log("step",$),r(0,$=$-1),console.log("step",$))},Ke=async()=>{const m=await $e.collection("feelings").getFullList({sort:"category"}),q=Ee(m);let D=de(q,"positive");D.map(C=>(C.content=de(C.content,"category"),C.content.map(y=>y.visible=!1),C)),console.log("res",D),r(1,f=D)},Qe=async()=>{const m=await $e.collection("needs").getFullList({sort:"category"}),q=Ee(m);let D=de(q,"category");D.map(C=>C.visible=!1),console.log("res",D),r(2,a=D)},We=async m=>{console.log("changeStep");const q=m.detail.step,D=await h(q);console.log("targetStepIsValid",D),D&&r(0,$=q)},Xe=(m,q)=>{if(m.nameEN!==q)return;const D=a.find(C=>C.category===q);D&&(D.visible=!D.visible),r(2,a=[...a])},Ye=(m,q)=>{if(m.nameEN!==q)return;const D=f[0].content.find(y=>y.category===q),C=f[1].content.find(y=>y.category===q);D&&(D.visible=!D.visible),C&&(C.visible=!C.visible),r(1,f=[...f])},Ze=(m,q)=>{const D=m.nameEN,C=q.category;return!!(D===C||q.visible)};at(async()=>{await Ke(),await Qe()}),$=1;function ye(m){ft.call(this,n,m)}function xe(m){n.$$.not_equal(e.name,m)&&(e.name=m,v.set(e))}function et(m){n.$$.not_equal(e.observation,m)&&(e.observation=m,v.set(e))}function tt(m){n.$$.not_equal(e.feelings,m)&&(e.feelings=m,v.set(e))}function lt(m){n.$$.not_equal(e.needs,m)&&(e.needs=m,v.set(e))}function rt(m){n.$$.not_equal(e.request,m)&&(e.request=m,v.set(e))}return n.$$.update=()=>{n.$$.dirty[0]&1&&(Ge.validators=u[$-1])},[$,f,a,k,w,_e,e,o,s,d,v,Q,He,We,Xe,Ye,Ze,ye,xe,et,tt,lt,rt]}class vl extends it{constructor(t){super(),ut(this,t,tl,el,Ue,{},null,[-1,-1])}}export{vl as component};
