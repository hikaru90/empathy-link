import{s as ke,e as N,a as j,c as V,b as q,f as g,g as z,p as B,i as v,h as M,k as ue,_ as St,n as Q,t as X,d as Z,j as x,I as Y,H as Qe,Y as It,x as be,y as Xe,K as le,$ as Bt,J as Dt,L as oe,G as Tt,O as ee,z as Ft,l as me,M as ve,T as Ze}from"../chunks/scheduler.BGpOBVyA.js";import{S as Te,i as Fe,c as k,a as E,m as C,g as K,b as p,e as W,t as m,d as S,f as ae}from"../chunks/index.wJhSdTM5.js";import{b as Nt,h as ye,i as Ee,e as te}from"../chunks/helpers.C2F2lmQ3.js";import{t as G,l as xe,u as Vt,f as yt,g as ge,a as pe}from"../chunks/page.BxjNqAN0.js";import{A as Jt}from"../chunks/AppTopMenu.bu7JEGYI.js";import{A as et}from"../chunks/AppBottomMenu.BG1J1hbK.js";import{e as se,z as jt,F as ce,C as _e,a as de,b as $e}from"../chunks/zod.DVU-mH4r.js";import{I as tt}from"../chunks/input.Dnbnrzao.js";import{A as rt,C as qt,a as zt,F as Ot,T as lt,b as nt,c as st}from"../chunks/textarea.BWl5-9Zr.js";import"../chunks/entry.B5Mv6Uxa.js";import{z as re,s as At}from"../chunks/memoize.DZzCiDwd.js";import{d as Mt}from"../chunks/index.BEk7VaRI.js";import{a as Ne}from"../chunks/button.A7J3RAYz.js";import{C as Ht}from"../chunks/CaretLeft.BzQWyqnQ.js";import{I as Lt}from"../chunks/icon-folder.CBGieXVr.js";import{I as Pt,a as Rt,b as Ut,c as Je}from"../chunks/icon-steps.dGSELuxl.js";import{p as Ce}from"../chunks/pocketbase.Ce4YzWbP.js";import{S as Gt}from"../chunks/Share.D1BOOZdv.js";function Kt(o){let e,l;return e=new Ht({props:{class:"h-4 w-4 rounded-full"}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p:Q,i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function Wt(o){let e,l;return e=new Ne({props:{type:"submit",decoration:"dark-op1",wrapperClass:"w-full",class:"flex w-full items-center gap-2 border-neutral-900 bg-neutral-800 text-sm text-zinc-200",$$slots:{default:[Qt]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r&264&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function Yt(o){let e,l;return e=new Ne({props:{decoration:"dark-op1",wrapperClass:"w-full",class:"flex w-full items-center gap-2 border-neutral-900 bg-neutral-800 text-sm text-zinc-200",$$slots:{default:[Xt]},$$scope:{ctx:o}}}),e.$on("click",o[5]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r&264&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function Qt(o){let e=o[3]("default.page.fights.form.general.next")+"",l,t,r,n;return r=new rt({props:{class:"h-3 w-3"}}),{c(){l=X(e),t=j(),k(r.$$.fragment)},l(s){l=Z(s,e),t=z(s),E(r.$$.fragment,s)},m(s,i){v(s,l,i),v(s,t,i),C(r,s,i),n=!0},p(s,i){(!n||i&8)&&e!==(e=s[3]("default.page.fights.form.general.next")+"")&&x(l,e)},i(s){n||(m(r.$$.fragment,s),n=!0)},o(s){p(r.$$.fragment,s),n=!1},d(s){s&&(g(l),g(t)),S(r,s)}}}function Xt(o){let e=o[3]("default.page.fights.form.general.checkJudgement")+"",l,t,r,n;return r=new rt({props:{class:"h-3 w-3"}}),{c(){l=X(e),t=j(),k(r.$$.fragment)},l(s){l=Z(s,e),t=z(s),E(r.$$.fragment,s)},m(s,i){v(s,l,i),v(s,t,i),C(r,s,i),n=!0},p(s,i){(!n||i&8)&&e!==(e=s[3]("default.page.fights.form.general.checkJudgement")+"")&&x(l,e)},i(s){n||(m(r.$$.fragment,s),n=!0)},o(s){p(r.$$.fragment,s),n=!1},d(s){s&&(g(l),g(t)),S(r,s)}}}function Zt(o){let e,l,t,r,n,s,i,f,a;t=new Ne({props:{decoration:"dark-op1",class:"flex items-center border-neutral-900 bg-neutral-800 px-1.5 text-sm text-zinc-200",$$slots:{default:[Kt]},$$scope:{ctx:o}}}),t.$on("click",o[4]);const u=[Yt,Wt],_=[];function h(c,b){return c[1]?0:1}return s=h(o),i=_[s]=u[s](o),{c(){e=N("div"),l=N("div"),k(t.$$.fragment),n=j(),i.c(),this.h()},l(c){e=V(c,"DIV",{class:!0});var b=q(e);l=V(b,"DIV",{class:!0});var d=q(l);E(t.$$.fragment,d),d.forEach(g),n=z(b),i.l(b),b.forEach(g),this.h()},h(){B(l,"class",r=(o[0]>1?"max-w-60 opacity-100":"max-w-0 opacity-0")+" group relative transform overflow-visible"),B(e,"class",f="flex justify-between "+o[2])},m(c,b){v(c,e,b),M(e,l),C(t,l,null),M(e,n),_[s].m(e,null),a=!0},p(c,[b]){const d={};b&256&&(d.$$scope={dirty:b,ctx:c}),t.$set(d),(!a||b&1&&r!==(r=(c[0]>1?"max-w-60 opacity-100":"max-w-0 opacity-0")+" group relative transform overflow-visible"))&&B(l,"class",r);let w=s;s=h(c),s===w?_[s].p(c,b):(K(),p(_[w],1,1,()=>{_[w]=null}),W(),i=_[s],i?i.p(c,b):(i=_[s]=u[s](c),i.c()),m(i,1),i.m(e,null)),(!a||b&4&&f!==(f="flex justify-between "+c[2]))&&B(e,"class",f)},i(c){a||(m(t.$$.fragment,c),m(i),a=!0)},o(c){p(t.$$.fragment,c),p(i),a=!1},d(c){c&&g(e),S(t),_[s].d()}}}function xt(o,e,l){let t;ue(o,G,_=>l(3,t=_));const r=St();let{step:n}=e,{checkForJudgement:s}=e,{class:i=void 0}=e,{primaryButtonClass:f=void 0}=e;const a=()=>{console.log("toPrev"),r("toPrev")},u=()=>{r("validateObservation")};return o.$$set=_=>{"step"in _&&l(0,n=_.step),"checkForJudgement"in _&&l(1,s=_.checkForJudgement),"class"in _&&l(2,i=_.class),"primaryButtonClass"in _&&l(6,f=_.primaryButtonClass)},[n,s,i,t,a,u,f]}class er extends Te{constructor(e){super(),Fe(this,e,xt,Zt,ke,{step:0,checkForJudgement:1,class:2,primaryButtonClass:6})}}const Se=re.object({name:re.string().min(3,{message:Y(G)("default.page.fights.form.name.tooShortError")}),title:re.string().min(3,{message:Y(G)("default.page.fights.form.title.tooShortError")})}),Ie=Se.extend({observation:re.string().min(10,{message:Y(G)("default.page.fights.form.observation.tooShortError")})}),Be=Ie.extend({feelings:re.array(re.string()).min(1,{message:Y(G)("default.page.fights.form.feelings.tooFewError")})}),De=Be.extend({needs:re.array(re.string()).min(1,{message:Y(G)("default.page.fights.form.needs.tooFewError")})}),ie=De.extend({request:re.string().optional()});function tr(o){let e;return{c(){e=N("div"),this.h()},l(l){e=V(l,"DIV",{id:!0,class:!0}),q(e).forEach(g),this.h()},h(){B(e,"id","speechBubble"),B(e,"class","w-full")},m(l,t){v(l,e,t),o[11](e)},p:Q,d(l){l&&g(e),o[11](null)}}}function rr(o){let e,l="...";return{c(){e=N("div"),e.textContent=l,this.h()},l(t){e=V(t,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),Qe(e)!=="svelte-534rav"&&(e.textContent=l),this.h()},h(){B(e,"id","speechBubble"),B(e,"class","w-full")},m(t,r){v(t,e,r)},p:Q,d(t){t&&g(e)}}}function je(o){let e,l,t,r,n,s,i,f,a,u;return r=new qt({props:{class:"size-2.5"}}),i=new zt({props:{class:"size-2.5"}}),{c(){e=N("div"),l=N("div"),t=N("button"),k(r.$$.fragment),n=j(),s=N("button"),k(i.$$.fragment),this.h()},l(_){e=V(_,"DIV",{class:!0});var h=q(e);l=V(h,"DIV",{class:!0});var c=q(l);t=V(c,"BUTTON",{class:!0});var b=q(t);E(r.$$.fragment,b),b.forEach(g),n=z(c),s=V(c,"BUTTON",{class:!0});var d=q(s);E(i.$$.fragment,d),d.forEach(g),c.forEach(g),h.forEach(g),this.h()},h(){B(t,"class","chevron svelte-12yl6i5"),B(s,"class","chevron svelte-12yl6i5"),B(l,"class","-mr-1 flex flex-col items-center gap-0.5"),B(e,"class","flex justify-end text-2xs")},m(_,h){v(_,e,h),M(e,l),M(l,t),C(r,t,null),M(l,n),M(l,s),C(i,s,null),f=!0,a||(u=[be(t,"click",o[12]),be(s,"click",o[13])],a=!0)},p:Q,i(_){f||(m(r.$$.fragment,_),m(i.$$.fragment,_),f=!0)},o(_){p(r.$$.fragment,_),p(i.$$.fragment,_),f=!1},d(_){_&&g(e),S(r),S(i),a=!1,Xe(u)}}}function lr(o){let e,l,t=`<div style="background-image: url(&#39;${Nt}&#39;); background-size: 300% 100%" class="animate-bg relative z-10 flex h-full w-[60px] items-center justify-center rounded-b rounded-t-[50px] shadow-lg transition duration-700"><div data-name="face" class="lookaround face-3 flex flex-col gap-1 svelte-12yl6i5"><div data-name="eyes" class="eyes flex items-center justify-center gap-2"><div class="h-2 w-2 rounded-full border-2 border-white bg-black shadow-md"></div> <div class="h-2 w-2 rounded-full border-2 border-white bg-black shadow-md"></div></div> <div data-name="mouth" class="mouth flex items-center justify-center svelte-12yl6i5"><div class="h-1.5 w-2.5 rounded-b-full bg-black"></div></div></div></div>`,r,n,s,i,f,a,u;function _(d,w){return d[2]?rr:tr}let h=_(o),c=h(o),b=o[1].length>1&&je(o);return{c(){e=N("div"),l=N("div"),l.innerHTML=t,r=j(),n=N("div"),s=N("div"),i=j(),f=N("div"),c.c(),a=j(),b&&b.c(),this.h()},l(d){e=V(d,"DIV",{class:!0});var w=q(e);l=V(w,"DIV",{class:!0,"data-svelte-h":!0}),Qe(l)!=="svelte-ido9h0"&&(l.innerHTML=t),r=z(w),n=V(w,"DIV",{class:!0});var D=q(n);s=V(D,"DIV",{class:!0}),q(s).forEach(g),i=z(D),f=V(D,"DIV",{class:!0});var T=q(f);c.l(T),a=z(T),b&&b.l(T),T.forEach(g),D.forEach(g),w.forEach(g),this.h()},h(){B(l,"class","relative left-0 right-0 flex h-12 flex-shrink-0 justify-center gap-1"),B(s,"class","triangle size-3 flex-shrink-0 bg-muted svelte-12yl6i5"),B(f,"class","rounded-tl-0 relative flex flex-grow rounded-b rounded-tr bg-muted px-2 pb-2 pt-1 text-sm leading-tight gap-2"),B(n,"class","flex flex-grow"),B(e,"class","mt-4 flex items-start gap-2")},m(d,w){v(d,e,w),M(e,l),M(e,r),M(e,n),M(n,s),M(n,i),M(n,f),c.m(f,null),M(f,a),b&&b.m(f,null),u=!0},p(d,[w]){h===(h=_(d))&&c?c.p(d,w):(c.d(1),c=h(d),c&&(c.c(),c.m(f,a))),d[1].length>1?b?(b.p(d,w),w&2&&m(b,1)):(b=je(d),b.c(),m(b,1),b.m(f,null)):b&&(K(),p(b,1,1,()=>{b=null}),W())},i(d){u||(m(b),u=!0)},o(d){p(b),u=!1},d(d){d&&g(e),c.d(),b&&b.d()}}}function nr(o,e,l){let t,r;ue(o,xe,F=>l(15,r=F));let{step:n}=e,{stepName:s}=e,{formSuccess:i}=e,{speechBubbleContentArray:f}=e,a=0,u=!1;const _=(F,H)=>{try{return H===13&&!F?f.find(U=>U.step===13).errorContent:f.find(U=>U.step===H).content}catch(U){return console.error("error in getSpeechBubbleContent",U),[]}};let h,c;const b=(F,H,U)=>{try{let I=function(){O<H.length&&(F.innerHTML+=H.charAt(O),O++,c=setTimeout(I,U))};console.log("typeText");let O=0;F.innerHTML="";const y=document.createElement("div");y.style.visibility="hidden",y.style.position="absolute",y.style.width=`${F.clientWidth}px`,y.style.color="red",y.style.whiteSpace="pre-wrap",y.innerText=H,F.appendChild(y);const P=y.clientHeight;F.style.height=`${P}px`,F.removeChild(y),c&&clearTimeout(c),I()}catch(I){console.error("error typing text",I)}},d=(F="Hi")=>{l(1,t=[t[0],F]),l(10,a=1)},w=async F=>{l(2,u=!0);try{const U=await(await fetch("/api/ai/checkForJudgement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:F,lang:r})})).json();l(2,u=!1);const I=U.result;d(I)}catch(H){console.error("error in getting judgement",H)}},D=()=>{console.log("decreaseIndex"),a>0&&l(10,a--,a)},T=()=>{console.log("increaseIndex"),t.length>1&&a===0&&l(10,a++,a)};It(()=>{c&&clearTimeout(c)});function he(F){le[F?"unshift":"push"](()=>{h=F,l(0,h)})}const fe=()=>D(),R=()=>T();return o.$$set=F=>{"step"in F&&l(5,n=F.step),"stepName"in F&&l(6,s=F.stepName),"formSuccess"in F&&l(7,i=F.formSuccess),"speechBubbleContentArray"in F&&l(8,f=F.speechBubbleContentArray)},o.$$.update=()=>{o.$$.dirty&160&&l(1,t=_(i,n)),o.$$.dirty&32&&l(10,a=0),o.$$.dirty&1027&&h&&(console.log("inside if speechBubbleElement"),b(h,t[a],30))},[h,t,u,D,T,n,s,i,f,w,a,he,fe,R]}class sr extends Te{constructor(e){super(),Fe(this,e,nr,lr,ke,{step:5,stepName:6,formSuccess:7,speechBubbleContentArray:8,checkJudgement:9})}get checkJudgement(){return this.$$.ctx[9]}}function qe(o,e,l){const t=o.slice();return t[53]=e[l],t}function ze(o,e,l){const t=o.slice();return t[61]=e[l],t}function Oe(o,e,l){const t=o.slice();return t[50]=e[l],t}function Ae(o,e,l){const t=o.slice();return t[53]=e[l],t}function Me(o,e,l){const t=o.slice();return t[56]=e[l],t}function He(o){let e,l;return e=new Ot({props:{step:o[0],steps:o[9],stepBackground:o[9][o[0]-1].slug}}),e.$on("changeStep",o[21]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.step=t[0]),r[0]&512&&(n.steps=t[9]),r[0]&513&&(n.stepBackground=t[9][t[0]-1].slug),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function or(o){let e;return{c(){e=N("div")},l(l){e=V(l,"DIV",{}),q(e).forEach(g)},m(l,t){v(l,e,t)},p:Q,i:Q,o:Q,d(l){l&&g(e)}}}function ar(o){let e;return{c(){e=N("div")},l(l){e=V(l,"DIV",{}),q(e).forEach(g)},m(l,t){v(l,e,t)},p:Q,i:Q,o:Q,d(l){l&&g(e)}}}function fr(o){let e,l,t;return l=new ce({props:{form:o[17],name:"request",$$slots:{default:[_r]},$$scope:{ctx:o}}}),{c(){e=N("div"),k(l.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var n=q(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){B(e,"class","form-content")},m(r,n){v(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&6144|n[2]&4&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){p(l.$$.fragment,r),t=!1},d(r){r&&g(e),S(l)}}}function ir(o){let e,l,t;return l=new ce({props:{form:o[17],name:"needs",$$slots:{default:[vr]},$$scope:{ctx:o}}}),{c(){e=N("div"),k(l.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var n=q(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){B(e,"class","form-content")},m(r,n){v(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&14340|n[2]&4&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){p(l.$$.fragment,r),t=!1},d(r){r&&g(e),S(l)}}}function ur(o){let e,l,t;return l=new ce({props:{form:o[17],name:"feelings",$$slots:{default:[Sr]},$$scope:{ctx:o}}}),{c(){e=N("div"),k(l.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var n=q(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){B(e,"class","form-content")},m(r,n){v(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&14851|n[2]&4&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){p(l.$$.fragment,r),t=!1},d(r){r&&g(e),S(l)}}}function cr(o){let e,l,t;return l=new ce({props:{form:o[17],name:"observation",$$slots:{default:[Dr]},$$scope:{ctx:o}}}),{c(){e=N("div"),k(l.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var n=q(e);E(l.$$.fragment,n),n.forEach(g),this.h()},h(){B(e,"class","form-content")},m(r,n){v(r,e,n),C(l,e,null),t=!0},p(r,n){const s={};n[0]&6208|n[2]&4&&(s.$$scope={dirty:n,ctx:r}),l.$set(s)},i(r){t||(m(l.$$.fragment,r),t=!0)},o(r){p(l.$$.fragment,r),t=!1},d(r){r&&g(e),S(l)}}}function mr(o){let e,l,t,r,n;return l=new ce({props:{form:o[17],name:"name",$$slots:{default:[Nr]},$$scope:{ctx:o}}}),r=new ce({props:{form:o[17],name:"title",$$slots:{default:[Jr]},$$scope:{ctx:o}}}),{c(){e=N("div"),k(l.$$.fragment),t=j(),k(r.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var i=q(e);E(l.$$.fragment,i),t=z(i),E(r.$$.fragment,i),i.forEach(g),this.h()},h(){B(e,"class","form-content")},m(s,i){v(s,e,i),C(l,e,null),M(e,t),C(r,e,null),n=!0},p(s,i){const f={};i[0]&6144|i[2]&4&&(f.$$scope={dirty:i,ctx:s}),l.$set(f);const a={};i[0]&6144|i[2]&4&&(a.$$scope={dirty:i,ctx:s}),r.$set(a)},i(s){n||(m(l.$$.fragment,s),m(r.$$.fragment,s),n=!0)},o(s){p(l.$$.fragment,s),p(r.$$.fragment,s),n=!1},d(s){s&&g(e),S(l),S(r)}}}function gr(o){let e=o[12]("default.page.fights.form.request.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.request.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function pr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[gr]},$$scope:{ctx:o}}});const s=[o[49],{class:"min-h-60"}];function i(a){o[33](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].request!==void 0&&(f.value=o[11].request),t=new lt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[pe(a[49]),s[1]]):{};!r&&u[0]&2048&&(r=!0,h.value=a[11].request,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function _r(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[pr,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&6144|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function dr(o){let e=o[12]("default.page.fights.form.needs.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.needs.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Le(o){let e,l,t=te(o[2]),r=[];for(let s=0;s<t.length;s+=1)r[s]=Re(qe(o,t,s));const n=s=>p(r[s],1,1,()=>{r[s]=null});return{c(){e=N("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=V(s,"DIV",{class:!0});var i=q(e);for(let f=0;f<r.length;f+=1)r[f].l(i);i.forEach(g),this.h()},h(){B(e,"class","-m-1 flex w-full flex-wrap justify-start transition-all")},m(s,i){v(s,e,i);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);l=!0},p(s,i){if(i[0]&20981764){t=te(s[2]);let f;for(f=0;f<t.length;f+=1){const a=qe(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Re(a),r[f].c(),m(r[f],1),r[f].m(e,null))}for(K(),f=t.length;f<r.length;f+=1)n(f);W()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)p(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function $r(o){let e=(o[13]==="de"?o[61].nameDE:o[61].nameEN)+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&8196&&e!==(e=(t[13]==="de"?t[61].nameDE:t[61].nameEN)+"")&&x(l,e)},d(t){t&&g(l)}}}function Pe(o){let e,l,t,r,n,s,i;return l=new st({props:{value:o[61].id,class:(o[61].nameEN===o[53].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-needs-foreground dark:data-[state=on]:bg-needs-foreground max-w-[300px]",$$slots:{default:[$r]},$$scope:{ctx:o}}}),{c(){e=N("button"),k(l.$$.fragment),t=j(),this.h()},l(f){e=V(f,"BUTTON",{type:!0,class:!0});var a=q(e);E(l.$$.fragment,a),t=z(a),a.forEach(g),this.h()},h(){B(e,"type","button"),B(e,"class",r=(o[24](o[61],o[53])||o[11].needs.includes(o[61].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all")},m(f,a){v(f,e,a),C(l,e,null),M(e,t),n=!0,s||(i=be(e,"click",function(){Ze(o[22](o[61],o[53].category))&&o[22](o[61],o[53].category).apply(this,arguments)}),s=!0)},p(f,a){o=f;const u={};a[0]&4&&(u.value=o[61].id),a[0]&4&&(u.class=(o[61].nameEN===o[53].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-needs-foreground dark:data-[state=on]:bg-needs-foreground max-w-[300px]"),a[0]&8196|a[2]&4&&(u.$$scope={dirty:a,ctx:o}),l.$set(u),(!n||a[0]&2052&&r!==(r=(o[24](o[61],o[53])||o[11].needs.includes(o[61].id)?"pointer-events-auto max-h-60 max-w-[1000px] p-1 opacity-100":"pointer-events-none m-0 max-h-0 max-w-0 p-0 opacity-0")+" transition-all"))&&B(e,"class",r)},i(f){n||(m(l.$$.fragment,f),n=!0)},o(f){p(l.$$.fragment,f),n=!1},d(f){f&&g(e),S(l),s=!1,i()}}}function Re(o){let e,l,t=te(o[53].content),r=[];for(let s=0;s<t.length;s+=1)r[s]=Pe(ze(o,t,s));const n=s=>p(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ee()},l(s){for(let i=0;i<r.length;i+=1)r[i].l(s);e=ee()},m(s,i){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(s,i);v(s,e,i),l=!0},p(s,i){if(i[0]&20981764){t=te(s[53].content);let f;for(f=0;f<t.length;f+=1){const a=ze(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Pe(a),r[f].c(),m(r[f],1),r[f].m(e.parentNode,e))}for(K(),f=t.length;f<r.length;f+=1)n(f);W()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)p(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function hr(o){let e,l,t=o[2].length>0&&Le(o);return{c(){t&&t.c(),e=ee()},l(r){t&&t.l(r),e=ee()},m(r,n){t&&t.m(r,n),v(r,e,n),l=!0},p(r,n){r[2].length>0?t?(t.p(r,n),n[0]&4&&m(t,1)):(t=Le(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),p(t,1,1,()=>{t=null}),W())},i(r){l||(m(t),l=!0)},o(r){p(t),l=!1},d(r){r&&g(e),t&&t.d(r)}}}function br(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[dr]},$$scope:{ctx:o}}});const s=[{type:"multiple"},o[49],{class:""}];function i(a){o[32](a)}let f={$$slots:{default:[hr]},$$scope:{ctx:o}};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].needs!==void 0&&(f.value=o[11].needs),t=new nt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[s[0],pe(a[49]),s[2]]):{};u[0]&10244|u[2]&4&&(h.$$scope={dirty:u,ctx:a}),!r&&u[0]&2048&&(r=!0,h.value=a[11].needs,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function vr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[br,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&14340|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function wr(o){let e=o[12]("default.page.fights.form.feelings.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.feelings.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Ue(o){let e,l,t=te(o[1]),r=[];for(let s=0;s<t.length;s+=1)r[s]=We(Oe(o,t,s));const n=s=>p(r[s],1,1,()=>{r[s]=null});return{c(){e=N("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=V(s,"DIV",{class:!0});var i=q(e);for(let f=0;f<r.length;f+=1)r[f].l(i);i.forEach(g),this.h()},h(){B(e,"class","")},m(s,i){v(s,e,i);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);l=!0},p(s,i){if(i[0]&25180675){t=te(s[1]);let f;for(f=0;f<t.length;f+=1){const a=Oe(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=We(a),r[f].c(),m(r[f],1),r[f].m(e,null))}for(K(),f=t.length;f<r.length;f+=1)n(f);W()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)p(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function kr(o){let e=(o[13]==="de"?o[56].nameDE:o[56].nameEN)+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&8194&&e!==(e=(t[13]==="de"?t[56].nameDE:t[56].nameEN)+"")&&x(l,e)},d(t){t&&g(l)}}}function Ge(o){let e,l,t,r,n,s;return l=new st({props:{value:o[56].id,class:(o[56].nameEN===o[53].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-feelings-foreground dark:data-[state=on]:bg-feelings-foreground max-w-[300px]",$$slots:{default:[kr]},$$scope:{ctx:o}}}),{c(){e=N("button"),k(l.$$.fragment),this.h()},l(i){e=V(i,"BUTTON",{type:!0,class:!0});var f=q(e);E(l.$$.fragment,f),f.forEach(g),this.h()},h(){B(e,"type","button"),B(e,"class",t=(o[24](o[56],o[53])||o[11].feelings.includes(o[56].id)?"pointer-events-auto max-w-[300px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all")},m(i,f){v(i,e,f),C(l,e,null),r=!0,n||(s=be(e,"click",function(){Ze(o[23](o[56],o[53].category))&&o[23](o[56],o[53].category).apply(this,arguments)}),n=!0)},p(i,f){o=i;const a={};f[0]&2&&(a.value=o[56].id),f[0]&2&&(a.class=(o[56].nameEN===o[53].category?"bg-white/40 dark:bg-muted font-bold":"border border-white/40 dark:border-white/20")+" py-0 text-black  shadow hover:text-black data-[state=on]:text-white dark:text-white data-[state=on]:bg-feelings-foreground dark:data-[state=on]:bg-feelings-foreground max-w-[300px]"),f[0]&8194|f[2]&4&&(a.$$scope={dirty:f,ctx:o}),l.$set(a),(!r||f[0]&2050&&t!==(t=(o[24](o[56],o[53])||o[11].feelings.includes(o[56].id)?"pointer-events-auto max-w-[300px] p-1 opacity-100":"pointer-events-none m-0 max-w-0 p-0 opacity-0")+" transition-all"))&&B(e,"class",t)},i(i){r||(m(l.$$.fragment,i),r=!0)},o(i){p(l.$$.fragment,i),r=!1},d(i){i&&g(e),S(l),n=!1,s()}}}function Ke(o){let e,l,t=te(o[53].content),r=[];for(let s=0;s<t.length;s+=1)r[s]=Ge(Me(o,t,s));const n=s=>p(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=ee()},l(s){for(let i=0;i<r.length;i+=1)r[i].l(s);e=ee()},m(s,i){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(s,i);v(s,e,i),l=!0},p(s,i){if(i[0]&25176066){t=te(s[53].content);let f;for(f=0;f<t.length;f+=1){const a=Me(s,t,f);r[f]?(r[f].p(a,i),m(r[f],1)):(r[f]=Ge(a),r[f].c(),m(r[f],1),r[f].m(e.parentNode,e))}for(K(),f=t.length;f<r.length;f+=1)n(f);W()}},i(s){if(!l){for(let i=0;i<t.length;i+=1)m(r[i]);l=!0}},o(s){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)p(r[i]);l=!1},d(s){s&&g(e),ve(r,s)}}}function We(o){let e,l=(o[50].category==="true"?o[12]("default.page.fights.form.general.goodFeelings"):o[12]("default.page.fights.form.general.badFeelings"))+"",t,r,n,s,i,f,a,u,_,h=te(o[50].content),c=[];for(let d=0;d<h.length;d+=1)c[d]=Ke(Ae(o,h,d));const b=d=>p(c[d],1,1,()=>{c[d]=null});return{c(){e=N("div"),t=X(l),r=j(),n=N("div"),f=j(),a=N("div");for(let d=0;d<c.length;d+=1)c[d].c();u=j(),this.h()},l(d){e=V(d,"DIV",{class:!0});var w=q(e);t=Z(w,l),r=z(w),n=V(w,"DIV",{class:!0}),q(n).forEach(g),w.forEach(g),f=z(d),a=V(d,"DIV",{class:!0});var D=q(a);for(let T=0;T<c.length;T+=1)c[T].l(D);u=z(D),D.forEach(g),this.h()},h(){B(n,"class",s="border-b border-"+o[9][o[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"),B(e,"class",i="text-"+o[9][o[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"),B(a,"class","-mx-1 flex w-full flex-wrap justify-start transition-all")},m(d,w){v(d,e,w),M(e,t),M(e,r),M(e,n),v(d,f,w),v(d,a,w);for(let D=0;D<c.length;D+=1)c[D]&&c[D].m(a,null);M(a,u),_=!0},p(d,w){if((!_||w[0]&4098)&&l!==(l=(d[50].category==="true"?d[12]("default.page.fights.form.general.goodFeelings"):d[12]("default.page.fights.form.general.badFeelings"))+"")&&x(t,l),(!_||w[0]&513&&s!==(s="border-b border-"+d[9][d[0]-1].slug+"-foreground mr-2 flex-grow border-opacity-20"))&&B(n,"class",s),(!_||w[0]&513&&i!==(i="text-"+d[9][d[0]-1].slug+"-foreground mb-1 mt-3 flex items-center gap-3 text-xs"))&&B(e,"class",i),w[0]&25176066){h=te(d[50].content);let D;for(D=0;D<h.length;D+=1){const T=Ae(d,h,D);c[D]?(c[D].p(T,w),m(c[D],1)):(c[D]=Ke(T),c[D].c(),m(c[D],1),c[D].m(a,u))}for(K(),D=h.length;D<c.length;D+=1)b(D);W()}},i(d){if(!_){for(let w=0;w<h.length;w+=1)m(c[w]);_=!0}},o(d){c=c.filter(Boolean);for(let w=0;w<c.length;w+=1)p(c[w]);_=!1},d(d){d&&(g(e),g(f),g(a)),ve(c,d)}}}function Er(o){let e,l,t=o[1].length>0&&Ue(o);return{c(){t&&t.c(),e=ee()},l(r){t&&t.l(r),e=ee()},m(r,n){t&&t.m(r,n),v(r,e,n),l=!0},p(r,n){r[1].length>0?t?(t.p(r,n),n[0]&2&&m(t,1)):(t=Ue(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),p(t,1,1,()=>{t=null}),W())},i(r){l||(m(t),l=!0)},o(r){p(t),l=!1},d(r){r&&g(e),t&&t.d(r)}}}function Cr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[wr]},$$scope:{ctx:o}}});const s=[{type:"multiple"},o[49],{class:"flex flex-col gap-4"}];function i(a){o[31](a)}let f={$$slots:{default:[Er]},$$scope:{ctx:o}};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].feelings!==void 0&&(f.value=o[11].feelings),t=new nt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[s[0],pe(a[49]),s[2]]):{};u[0]&14851|u[2]&4&&(h.$$scope={dirty:u,ctx:a}),!r&&u[0]&2048&&(r=!0,h.value=a[11].feelings,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function Sr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Cr,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&14851|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function Ir(o){let e=o[12]("default.page.fights.form.observation.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.observation.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Br(o){let e,l,t,r,n;e=new $e({props:{class:"form-label",$$slots:{default:[Ir]},$$scope:{ctx:o}}});const s=[o[49],{class:"min-h-60"}];function i(a){o[29](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].observation!==void 0&&(f.value=o[11].observation),t=new lt({props:f}),le.push(()=>ae(t,"value",i)),t.$on("input",o[30]),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[pe(a[49]),s[1]]):{};!r&&u[0]&2048&&(r=!0,h.value=a[11].observation,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function Dr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Br,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&6208|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function Tr(o){let e=o[12]("default.page.fights.form.name.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.name.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function Fr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label ",$$slots:{default:[Tr]},$$scope:{ctx:o}}});const s=[o[49]];function i(a){o[27](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].name!==void 0&&(f.value=o[11].name),t=new tt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[pe(a[49])]):{};!r&&u[0]&2048&&(r=!0,h.value=a[11].name,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function Nr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[Fr,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&6144|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function Vr(o){let e=o[12]("default.page.fights.form.title.label")+"",l;return{c(){l=X(e)},l(t){l=Z(t,e)},m(t,r){v(t,l,r)},p(t,r){r[0]&4096&&e!==(e=t[12]("default.page.fights.form.title.label")+"")&&x(l,e)},d(t){t&&g(l)}}}function yr(o){let e,l,t,r,n;e=new $e({props:{class:"form-label ",$$slots:{default:[Vr]},$$scope:{ctx:o}}});const s=[o[49]];function i(a){o[28](a)}let f={};for(let a=0;a<s.length;a+=1)f=me(f,s[a]);return o[11].title!==void 0&&(f.value=o[11].title),t=new tt({props:f}),le.push(()=>ae(t,"value",i)),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(a){E(e.$$.fragment,a),l=z(a),E(t.$$.fragment,a)},m(a,u){C(e,a,u),v(a,l,u),C(t,a,u),n=!0},p(a,u){const _={};u[0]&4096|u[2]&4&&(_.$$scope={dirty:u,ctx:a}),e.$set(_);const h=u[1]&262144?ge(s,[pe(a[49])]):{};!r&&u[0]&2048&&(r=!0,h.value=a[11].title,oe(()=>r=!1)),t.$set(h)},i(a){n||(m(e.$$.fragment,a),m(t.$$.fragment,a),n=!0)},o(a){p(e.$$.fragment,a),p(t.$$.fragment,a),n=!1},d(a){a&&g(l),S(e,a),S(t,a)}}}function Jr(o){let e,l,t,r;return e=new _e({props:{$$slots:{default:[yr,({attrs:n})=>({49:n}),({attrs:n})=>[0,n?262144:0]]},$$scope:{ctx:o}}}),t=new de({}),{c(){k(e.$$.fragment),l=j(),k(t.$$.fragment)},l(n){E(e.$$.fragment,n),l=z(n),E(t.$$.fragment,n)},m(n,s){C(e,n,s),v(n,l,s),C(t,n,s),r=!0},p(n,s){const i={};s[0]&6144|s[1]&262144|s[2]&4&&(i.$$scope={dirty:s,ctx:n}),e.$set(i)},i(n){r||(m(e.$$.fragment,n),m(t.$$.fragment,n),r=!0)},o(n){p(e.$$.fragment,n),p(t.$$.fragment,n),r=!1},d(n){n&&g(l),S(e,n),S(t,n)}}}function Ye(o){let e,l,t,r;const n=[mr,cr,ur,ir,fr,ar,or],s=[];function i(f,a){return f[0]===1?0:f[0]===2?1:f[0]===3?2:f[0]===4?3:f[4]?f[5]?5:6:4}return e=i(o),l=s[e]=n[e](o),{c(){l.c(),t=ee()},l(f){l.l(f),t=ee()},m(f,a){s[e].m(f,a),v(f,t,a),r=!0},p(f,a){let u=e;e=i(f),e===u?s[e].p(f,a):(K(),p(s[u],1,1,()=>{s[u]=null}),W(),l=s[e],l?l.p(f,a):(l=s[e]=n[e](f),l.c()),m(l,1),l.m(t.parentNode,t))},i(f){r||(m(l),r=!0)},o(f){p(l),r=!1},d(f){f&&g(t),s[e].d(f)}}}function jr(o){let e,l;return e=new et({props:{$$slots:{default:[zr]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&384|r[2]&4&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function qr(o){let e,l;return e=new et({props:{$$slots:{default:[Or]},$$scope:{ctx:o}}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&1089|r[2]&4&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function zr(o){let e,l;return e=new Gt({props:{id:o[7],record:o[8]}}),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&128&&(n.id=t[7]),r[0]&256&&(n.record=t[8]),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function Or(o){let e,l;return e=new er({props:{step:o[0],checkForJudgement:o[6],primaryButtonClass:o[10],class:"flex-shrink-0"}}),e.$on("validateObservation",o[15]),e.$on("disableJudgementCheck",o[16]),e.$on("toPrev",o[20]),{c(){k(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,r){C(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.step=t[0]),r[0]&64&&(n.checkForJudgement=t[6]),r[0]&1024&&(n.primaryButtonClass=t[10]),e.$set(n)},i(t){l||(m(e.$$.fragment,t),l=!0)},o(t){p(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function Ar(o){let e,l,t,r,n,s,i,f,a,u=o[0],_,h,c,b,d,w,D;l=new Jt({});let T=!o[4]&&!o[5]&&He(o);function he(I){o[26](I)}let fe={speechBubbleContentArray:o[14],step:o[0],stepName:o[9][o[0]-1].slug,formSuccess:o[5]};o[3]!==void 0&&(fe.checkJudgement=o[3]),i=new sr({props:fe}),le.push(()=>ae(i,"checkJudgement",he));let R=Ye(o);const F=[qr,jr],H=[];function U(I,O){return!I[4]&&!I[5]?0:1}return h=U(o),c=H[h]=F[h](o),{c(){e=N("div"),k(l.$$.fragment),t=j(),r=N("div"),n=N("form"),T&&T.c(),s=j(),k(i.$$.fragment),a=j(),R.c(),_=j(),c.c(),this.h()},l(I){e=V(I,"DIV",{class:!0});var O=q(e);E(l.$$.fragment,O),t=z(O),r=V(O,"DIV",{class:!0});var y=q(r);n=V(y,"FORM",{class:!0});var P=q(n);T&&T.l(P),s=z(P),E(i.$$.fragment,P),a=z(P),R.l(P),_=z(P),c.l(P),P.forEach(g),y.forEach(g),O.forEach(g),this.h()},h(){B(n,"class","-mt-1 flex h-full flex-grow flex-col pb-[74px]"),B(r,"class","max-container relative flex flex-grow flex-col pb-40"),B(e,"class",b="flex flex-grow flex-col justify-between transition duration-500 "+o[10]+" dark:bg-background min-h-svh overflow-hidden")},m(I,O){v(I,e,O),C(l,e,null),M(e,t),M(e,r),M(r,n),T&&T.m(n,null),M(n,s),C(i,n,null),M(n,a),R.m(n,null),M(n,_),H[h].m(n,null),d=!0,w||(D=[be(n,"submit",Bt(o[25])),Dt(o[19].call(null,n))],w=!0)},p(I,O){!I[4]&&!I[5]?T?(T.p(I,O),O[0]&48&&m(T,1)):(T=He(I),T.c(),m(T,1),T.m(n,s)):T&&(K(),p(T,1,1,()=>{T=null}),W());const y={};O[0]&1&&(y.step=I[0]),O[0]&513&&(y.stepName=I[9][I[0]-1].slug),O[0]&32&&(y.formSuccess=I[5]),!f&&O[0]&8&&(f=!0,y.checkJudgement=I[3],oe(()=>f=!1)),i.$set(y),O[0]&1&&ke(u,u=I[0])?(K(),p(R,1,1,Q),W(),R=Ye(I),R.c(),m(R,1),R.m(n,_)):R.p(I,O);let P=h;h=U(I),h===P?H[h].p(I,O):(K(),p(H[P],1,1,()=>{H[P]=null}),W(),c=H[h],c?c.p(I,O):(c=H[h]=F[h](I),c.c()),m(c,1),c.m(n,null)),(!d||O[0]&1024&&b!==(b="flex flex-grow flex-col justify-between transition duration-500 "+I[10]+" dark:bg-background min-h-svh overflow-hidden"))&&B(e,"class",b)},i(I){d||(m(l.$$.fragment,I),m(T),m(i.$$.fragment,I),m(R),m(c),d=!0)},o(I){p(l.$$.fragment,I),p(T),p(i.$$.fragment,I),p(R),p(c),d=!1},d(I){I&&g(e),S(l),T&&T.d(),S(i),R.d(I),H[h].d(),w=!1,Xe(D)}}}function Mr(o,e,l){let t,r,n,s,i;ue(o,Vt,$=>l(35,n=$)),ue(o,G,$=>l(12,s=$)),ue(o,xe,$=>l(13,i=$));const f=Mt(se(ie));let a=[],u=[],_;const h=[se(Se),se(Ie),se(Be),se(De),se(ie)];let c=1,b=!1,d=!1,w=!1,D,T;const he=$=>{const J=`bg-${we[$-1].slug}-background`;return yt.set(J),J},fe=[{step:1,content:[s("default.page.fight.create.info")]},{step:2,content:[s("default.page.fight.create.observation")]},{step:3,content:[s("default.page.fight.create.feelings")]},{step:4,content:[s("default.page.fight.create.needs")]},{step:5,content:[s("default.page.fight.create.request")]},{step:6,content:[s("default.page.fight.create.success")],errorContent:[s("default.page.fight.create.error")]}],R=async()=>{try{let $=r;$.owner=n.id,console.log("submit form",$);const J=await Ce.collection("fights").create($);l(7,D=J.id),l(8,T=J),l(5,d=!0),l(4,b=!0)}catch($){console.log("error handling submit",$),l(5,d=!1),l(4,b=!0)}},F=async $=>{const A=Object.keys(se([Se,Ie,Be,De,ie][$-1]).constraints);let L=!0;for(const ne of A)await at(ne,{update:!1})&&(L=!1);return!!L},H=async()=>{const $=await Ve(ie);return $.valid?!0:(P.set($.errors),!1)},U=async()=>{const $=await Ve(ie);return $.errors.observation?(P.set($.errors),!1):(I(),!0)},I=()=>{_(r.observation),l(6,w=!1)},O=At(f,{resetForm:!1,validators:jt(ie),async onSubmit({validators:$,cancel:J}){console.log("onSubmit"),J(),await H()&&(c==h.length&&R(),l(0,c++,c))},async onUpdated({form:$}){console.log("onUpdated"),$.valid&&l(0,c=1)}}),{form:y,errors:P,message:Hr,enhance:ot,validate:at,validateForm:Ve,options:ft,updateForm:Lr}=O;ue(o,y,$=>l(11,r=$)),y.subscribe($=>{console.log("form was updated",$)});let we=[{slug:"info",name:Y(G)("default.page.fights.form.general.steps.info"),icon:Lt,invertedTextColor:!1,hidden:!1},{slug:"observation",name:Y(G)("default.page.fights.form.general.steps.observation"),icon:Pt,invertedTextColor:!0,hidden:!1},{slug:"feelings",name:Y(G)("default.page.fights.form.general.steps.feelings"),icon:Rt,invertedTextColor:!1,hidden:!1},{slug:"needs",name:Y(G)("default.page.fights.form.general.steps.needs"),icon:Ut,invertedTextColor:!1,hidden:!1},{slug:"request",name:Y(G)("default.page.fights.form.general.steps.request"),icon:Je,invertedTextColor:!1,hidden:!1},{slug:"success",name:Y(G)("default.page.fights.form.general.steps.success"),icon:Je,invertedTextColor:!1,hidden:!0}];G.subscribe($=>{const J=we.map(A=>{const L=$(`default.page.fights.form.general.steps.${A.slug}`);return A.name=L,A});l(9,we=[...J])});const it=()=>{console.log("decreaseStep"),c>1&&(console.log("step",c),l(0,c=c-1),console.log("step",c))},ut=async()=>{const $=await Ce.collection("feelings").getFullList({sort:"category,sort"}),J=ye($);let A=Ee(J,"positive");A.map(L=>(L.content=Ee(L.content,"category"),L.content.map(ne=>ne.visible=!1),L)),console.log("feelings res",A),l(1,a=A)},ct=async()=>{const $=await Ce.collection("needs").getFullList({sort:"category"}),J=ye($);let A=Ee(J,"category");A.map(L=>L.visible=!1),console.log("res",A),l(2,u=A)},mt=async $=>{console.log("changeStep");const J=$.detail.step,A=await F(J);console.log("targetStepIsValid",A),A&&l(0,c=J)},gt=($,J)=>{if($.nameEN!==J)return;const A=u.find(L=>L.category===J);A&&(A.visible=!A.visible),l(2,u=[...u])},pt=($,J)=>{if($.nameEN!==J)return;const A=a[0].content.find(ne=>ne.category===J),L=a[1].content.find(ne=>ne.category===J);A&&(A.visible=!A.visible),L&&(L.visible=!L.visible),l(1,a=[...a])},_t=($,J)=>{const A=$.nameEN,L=J.category;return!!(A===L||J.visible)};Tt(async()=>{await ut(),await ct()}),c=3;function dt($){Ft.call(this,o,$)}function $t($){_=$,l(3,_)}function ht($){o.$$.not_equal(r.name,$)&&(r.name=$,y.set(r))}function bt($){o.$$.not_equal(r.title,$)&&(r.title=$,y.set(r))}function vt($){o.$$.not_equal(r.observation,$)&&(r.observation=$,y.set(r))}const wt=()=>l(6,w=!0);function kt($){o.$$.not_equal(r.feelings,$)&&(r.feelings=$,y.set(r))}function Et($){o.$$.not_equal(r.needs,$)&&(r.needs=$,y.set(r))}function Ct($){o.$$.not_equal(r.request,$)&&(r.request=$,y.set(r))}return o.$$.update=()=>{o.$$.dirty[0]&1,o.$$.dirty[0]&1&&(ft.validators=h[c-1]),o.$$.dirty[0]&1&&l(10,t=he(c))},[c,a,u,_,b,d,w,D,T,we,t,r,s,i,fe,U,I,O,y,ot,it,mt,gt,pt,_t,dt,$t,ht,bt,vt,wt,kt,Et,Ct]}class fl extends Te{constructor(e){super(),Fe(this,e,Mr,Ar,ke,{},null,[-1,-1,-1])}}export{fl as component};
